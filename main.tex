% Opcje klasy 'iithesis' opisane sa w komentarzach w pliku klasy. Za ich pomoca
% ustawia sie przede wszystkim jezyk i rodzaj (lic/inz/mgr) pracy, oraz czy na
% drugiej stronie pracy ma byc skladany wzor oswiadczenia o autorskim wykonaniu.
\documentclass[declaration,shortabstract]{iithesis}

\usepackage[utf8]{inputenc}
\usepackage{amsthm}
\usepackage{listings}
\usepackage{lipsum}
% \usepackage{listings}
\usepackage{enumitem}
% \usepackage[linesnumbered,vlined]{algorithm2e}
\usepackage{algorithm,algpseudocode}
% \usepackage[shortlabels]{enumitem}
% \usepackage{alg}
% \usepackage{theoremref}
% \usepackage[colorlinks, bookmarks=true]{hyperref}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{enumitem}
\usepackage[backend=bibtex,style=ieee]{biblatex}
% \bibliography{main}
\nocite{*}
\addbibresource{main.bib}

% \usepackage{autoref}
% \usepackage{graphicx,listings,amsmath,amssymb,amsthm,amsfonts,tikz}
% \SetKwInput{KwData}{Dane wejściowe}
% \SetKwInput{KwResult}{Wynik}

%%%%% DANE DO STRONY TYTUŁOWEJ
% Niezaleznie od jezyka pracy wybranego w opcjach klasy, tytul i streszczenie
% pracy nalezy podac zarowno w jezyku polskim, jak i angielskim.
% Pamietaj o madrym (zgodnym z logicznym rozbiorem zdania oraz estetyka) recznym
% zlamaniu wierszy w temacie pracy, zwlaszcza tego w jezyku pracy. Uzyj do tego
% polecenia \fmlinebreak.
\polishtitle    {Implementacja algorytmu sprawdzającego pierwszość liczby w czasie wielomianowym}
\englishtitle   {Implementation of polynomial time primality test}

% w pracach wielu autorow nazwiska mozna oddzielic poleceniem \and
\author         {Martyna Siejba}
% w przypadku kilku promotorow, lub koniecznosci podania ich afiliacji, linie
% w ponizszym poleceniu mozna zlamac poleceniem \fmlinebreak
\advisor        {prof. Krzysztof Loryś}

\polishabstract {Celem niniejszej pracy jest przedstawienie algorytmu AKS w sposób przystępny dla czytelnika o podstawowej wiedzy z zakresu algebry. Praca ta jest więc rozszerzeniem artykułu M. Agrawala, N. Kayala i N. Saxeny \textit{PRIMES is in P} o dowody pomocniczych lematów oraz wykorzystanych twierdzeń algebry abstrakcyjnej. 

Początkowa część pracy poświęcona jest wprowadzeniu potrzebnych do przeprowadzenia wywodu o algorytmie AKS pojęć algebry abstrakcyjnej - zdefiniowaniu pierścienia, ciała, grupy pierwiastków z jedności oraz wielomianu cyklotomicznego. Część ta zawiera także dowody użytych w dalszych rozdziałach pracy twierdzeń algebry abstrakcyjnej. Jest ona wstępem do głównego tematu pracy, czyli prezentacji algorytmu AKS i dowodu jego poprawności. Wywód służący udowodnieniu poprawności algorytmu uzupełnia artykuł \textit{PRIMES is in P} o dowody nieoczywistych lematów pomocniczych. Ponadto dowody wszystkich własności algebry znaleźć można w początkowej części pracy. Praca zawiera też ograniczenie złożoności algorytmu. Zaprezentowany dowód nie wykorzystuje najsilniejszego znanego ograniczenia, a służy jedynie pokazaniu, że złożoność algorytmu jest wielomianowa.

Dodatkowym celem pracy jest zaprezentowanie przykładowej implementacji algorytmu AKS w języku C++.}
\englishabstract{To samo in inglisz.}
%\date          {}                     % Data zlozenia pracy
% Dane do oswiadczenia o autorskim wykonaniu
%\transcriptnum {}                     % Numer indeksu
%\advisorgen    {dr. Jana Kowalskiego} % Nazwisko promotora w dopelniaczu
%%%%%

%%%%% WLASNE DODATKOWE PAKIETY
%
% \usepackage{graphicx,listings,amsmath,amssymb,amsthm,amsfonts,tikz}
%
%%%%% WŁASNE DEFINICJE I POLECENIA
%
% \theoremstyle{definition} \newtheorem{definition}{Definition}[chapter]

%\renewcommand \qedsymbol {\ensuremath{\square}}
% ...
%%%%%
% \renewcommand{\/}{\thesection\arabic{lstlisting}}
\renewcommand{\algorithmicrequire}{\textbf{Dane wejściowe:}}
\renewcommand{\algorithmicensure}{\textbf{Wynik:}}
\theoremstyle{definition}
\newtheorem{definition}{Definicja}
\theoremstyle{remark} \newtheorem{observation}{Obserwacja}
\theoremstyle{plain} \newtheorem{theorem}{Twierdzenie}
\theoremstyle{plain} \newtheorem{lemma}{Lemat}
\theoremstyle{remark} \newtheorem*{remark*}{Uwaga}
\theoremstyle{reminder} \newtheorem*{reminder*}{Przypomnienie}
% \usepackage{etoolbox}
% \makeatletter
% \patchcmd{\@makechapterhead}% <cmd>
%   {\thechapter}% <search>
%   {\thechapter.}% <replace>
%   {}{}% <success><failure>
% \renewcommand{\@seccntformat}[1]{\csname the#1\endcsname.\quad}
% \makeatother

\makeatletter
\newenvironment{breakablealgorithm}
  {% \begin{breakablealgorithm}
   \begin{center}
     \refstepcounter{algorithm}% New algorithm
     \hrule height.8pt depth0pt \kern2pt% \@fs@pre for \@fs@ruled
     \renewcommand{\caption}[2][\relax]{% Make a new \caption
       {\raggedright\textbf{\ALG@name~\thealgorithm} ##2\par}%
       \ifx\relax##1\relax % #1 is \relax
         \addcontentsline{loa}{algorithm}{\protect\numberline{\thealgorithm}##2}%
       \else % #1 is not \relax
         \addcontentsline{loa}{algorithm}{\protect\numberline{\thealgorithm}##1}%
       \fi
       \kern2pt\hrule\kern2pt
     }
  }{% \end{breakablealgorithm}
     \kern2pt\hrule\relax% \@fs@post for \@fs@ruled
   \end{center}
  }
\makeatother

\begin{document}

%%%%% POCZĄTEK ZASADNICZEGO TEKSTU PRACY

\chapter{Wstęp}

Problem testu pierwszości, nazwany PRIMES, polega na ustaleniu dla danej liczby naturalnej $n$, czy jest ona liczbą pierwszą. Jako że wejście składa się z jednej liczby, a naiwny deterministyczny algorytm jest w stanie stwierdzić pierwszość w czasie $O(\sqrt{n})$, za rozmiar problemu uznaje się długość liczby na wejściu \cite[s. 1-2]{dietz}.

Przy takiej definicji problemu PRIMES nieoczywista była jego przynależność do klas złożoności P i NP. Zawieranie w klasie NP zostało po raz pierwszy udowodnione przez Vaughana Pratta w 1975 roku \cite{pratt}. Od tego momentu głównym wyzwaniem związanym z problemem było pokazanie jego zawierania lub niezawierania się w klasie P. Przesłankami sugerującymi przynależność PRIMES do klasy P były własności liczb pierwszych wykorzystywane w probablistycznych testach pierwszości. Najprostszym takim testem jest test pierwszości Fermata, opierającym się na Małym Twierdzeniu Fermata, czyli twierdzeniu, że dla liczby pierwszej $p$ i liczby naturalnej $a$ takiej, że $NWD(a, p) = 1$ zachodzi $a^{p-1} = 1 \; (mod \, p)$. Test Fermata polega więc na losowym wyborze $a$ spełniającego założenia twierdzenia i sprawdzeniu, czy równość z twierdzenia zachodzi \cite[s. 73-76]{dietz}. Problemem tego podejścia jest fakt, że implikacja w drugą stronę nie zawsze jest prawdziwa. Istnieją bowiem liczby złożone $p$, nazywane liczbami pseudopierwszymi Fermata, dla których istnieje $a$ takie, że równość Małego Twierdzenia Fermata jest spełniona. Z tego powodu test Fermata nie jest algorytmem deterministycznym. Innym, powszechnie wykorzystywanym w praktyce probablistycznym podejściem jest test pierwszości Millera-Rabina, który także oparty jest na Małym Twierdzeniu Fermata \cite[s. 81-82]{dietz}.

W 2002 roku Manindra Agrawal, Neeraj Kayal i Nitin Saxena zaprezentowali deterministyczny test pierwszości o wielomianowej złożoności. Chociaż algorytm AKS jest mniej powszechnie wykorzystywany w praktyce niż probablistyczny test Millera-Rabina, ma on duże znaczenie w informatyce, jako że jest pierwszym dowodem na przynależność problemu PRIMES do klasy P \cite[s. 9]{dietz}.

Celem niniejszej pracy jest właśnie przedstawienie czytelnikowi algorytmu AKS oraz uzasadnienie jego poprawności w zrozumiały sposób. Praca ta jest uzupełnieniem oryginalnej pracy Agrawala, Kayala i Saxeny o dowody nietrywialnych lematów i dodatkowe komentarze, ułatwiające zrozumienie wywodu.

Ponieważ dowód poprawności wymaga znajomości pewnych pojęć i twierdzeń algebry abstrakcyjnej, rozdział 2. poświęcony jest ich wprowadzeniu. Od czytelnika wymagana jest znajomość podstaw algebry, głównie teorii grup. Wprowadzone pojęcia i związane z nimi lematy obejmują pierścienie, ciała, pierścienie wielomianów, pierwiastki z jedności nad ciałem i wielomiany cyklotomiczne. Dla komfortu czytelnika dla zdecydowanej większości twierdzeń i lematów, nawet trywialnych, przedstawiony jest także ich dowód.

Trzeci rozdział jest poświęcony przedstawieniu i udowodnieniu poprawności algorytmu. Główna jego część ma formę serii lematów i twierdzeń, potrzebnych do uzasadnienia końcowego twierdzenia o poprawności algorytmu AKS. Wszystkie potrzebne w tej części twierdzenia algebry abstrakcyjnej są udowodnione w poprzednim rozdziale.

Rozdział czwarty poświęcony jest oszacowaniu złożoności obliczeniowej testu. Ponieważ szacowanie jest dość bezpośrednie, jest to rozdział krótki i nieskomplikowany.

Ostatni rozdział odnosi się do implementacji algorytmu AKS w języku C++. Celem zaimplementowania testu jest jest przede wszystkim pokazanie prostoty implementacji. Nie powinna ona bowiem sprawić trudności programiście z dobrą znajomością klasycznych algorytmów, w szczególności wyszukiwania binarnego i FFT.

% Niemniej jednak test pierwszości AKS jest pierwszym dowodem na przynależność PRIMES do klasy P, przez co ma duże znaczenie w rozwoju teorii liczb w informatyce.
%ma kluczowe znaczenie w pracy nad tym problemem.

% Niemniej jednak ze względu na dużą złożoność obliczeniową testu AKS oraz wysoką dokładność testu Millera-Rabina.



% Zanim w 2002 roku ostatecznie przedstawiono deterministyczny test pierwszości o wielomianowej złożoności, 

% w literaturze pojawiały się przesłanki, wskazujące, że PRIMES prawdopodobnie należy do P.

%ciekawym zagadnieniem okazuje się być stiwerdzenie jego przynależności do klas złożoności NP i P. Zawieranie się PRIMES w klasie NP zostało pierwszy raz udowodnione przez Vaughana Pratta w 1975 roku. 

%nazwany PRIMES, jest tematem szeroko poruszanym w literaturze, którego przynależność do klasy złożoności 

% Celem niniejszej pracy jest przedstawienie algorytmu AKS w sposób zrozumiały dla czytelnika o podstawowej wiedzy z zakresu algebry abstrokcyjnej.

\chapter{Podstawy algebraiczne}

Aby udowodnić poprawność algorytmu AKS potrzebne nam będą podstawowe pojęcia oraz twierdzenia algebry abstrakcyjnej, w szczególności własności pierścieni ilorazowych oraz wielomianów cyklotomicznych i pierwiastków z jedności nad ciałem. Poniższy rozdział poświęcony jest więc wprowadzeniu tych pojęć oraz udowodnieniu twierdzeń przydatnych później w dowodzie poprawności algorytmu AKS.

\section{Pierścień, ciało, pierścień ilorazowy}

Zdefiniujmy najpierw podstawowe struktury algebraiczne, których własności będziemy często wykorzystywać w dowodach lematów i twierdzeń, prowadzących do udowodnienia poprawności algorytmu.

\theoremstyle{definition} 
\begin{definition}
	Zbiór $R$ zamknięty na dwie operacje binarne $\oplus$ (dodawanie) oraz $\odot$ (mnożenie) nazywamy \textit{\textbf{pierścieniem}} i oznaczamy $\langle R, \oplus, \odot \rangle$, jeśli 
	\begin{itemize}[leftmargin=.4in]
		\item $\oplus$ jest przemienna ($\forall_{a, b \in R} \, a \oplus b = b \oplus a$) oraz łączna ($\forall_{a, b, c \in R} \, (a \oplus b) \oplus c = a \oplus (b \oplus c)$);
		\item zawiera element zerowy ($\exists_{0 \in R} \forall_{a \in R} \, a \oplus 0 = 0 \oplus a = a$);
		\item dla każdego elementu zawiera element przeciwny ($\forall_{a \in R} \exists_{(-a) \in R} \, a \oplus (-a) = 0$);
		\item $\odot$ jest łączna ($\forall_{a, b, c \in R} \, (a \odot b) \odot c = a \odot (b \odot c)$);
		\item $\oplus$ jest rozdzielna względem $\odot$ ($\forall_{a, b, c \in R} \, a \odot (b \oplus c) = (a \odot b) \oplus (a \odot c) \wedge (a \oplus b) \odot c = (a \odot c) \oplus (b \odot c)$).
	\end{itemize}
	% Jeśli dodatkowo mnożenie jest przemienne ($\forall_{a, b \in R} \, a \odot b = b \odot a$), to pierścień nazywamy \textit{\textbf{przemiennym}}.
	% \end{minipage}
\end{definition}

\theoremstyle{observation}
\begin{observation}
	Każdy pierścień jest grupą.
\end{observation}

\begin{remark*}
	W przypadku, gdy oczywistym jest, jaka operacja mnożenia jest rozważana, wyrażenie $ab$ będzie skróconym zapisem operacji mnożenia argumentów $a, \,b$.
\end{remark*}

\theoremstyle{definition}
\begin{definition}
	Pierścień $\langle R, \oplus, \odot \rangle$ nazywamy \textit{\textbf{przemiennym}} jeśli $\forall_{a, b \in R} \, ab = ba$.
\end{definition}

Możemy teraz zauważyć, że pierścieniem jest na przykład zbiór liczb całkowitych z dodawaniem i mnożeniem lub zbiór wielomianów o współczynnikach całkowitych z dodawaniem i mnożeniem wielomianów.

\theoremstyle{definition} 
\begin{definition} \label{cialo}
	Pierścień $\langle F, \oplus, \odot \rangle$ nazywamy \textit{\textbf{ciałem}}, jeśli 
	\begin{itemize}[leftmargin=.4in]
		\item istnieje element $1 \in F$, będący elementem neutralnym mnożenia ($\forall_{a \in F} \, a1 = 1a = a$) oraz
		\item jeśli $0$ jest elementem zerowym pierścienia $\langle F, \oplus, \odot \rangle$, to $\langle F \setminus \{0\}, \odot \rangle$ jest grupą abelową, której elementem neutralnym jest $1$.
	\end{itemize}
	Ciało takie będziemy oznaczać $\langle F, \oplus, \odot, 0, 1 \rangle$. W dodatku \textbf{\textit{rzędem}} ciała $\langle F, \oplus, \odot, 0, 1 \rangle$ nazywać będziemy moc zbioru $F$.
\end{definition}

Innymi słowy ciało jest pierścieniem z elementem neutralnym mnożenia, w którym dla każdego niezerowego elementu istnieje element odwrotny. Przykładem ciał są zbiory reszt z dzielenia przez liczbę pierwszą z operacjami dodawania i mnożenia modulo. Jeśli rozważymy natomiast wcześniej przywołane przykłady pierścieni, możemy zauważyć, że zarówno zbiór liczb całkowitych jak i zbiór wielomianów o całkowitych współczynnikach nie jest ciałem. W obu przykładach zbiory te nie spełniają warunku na istnienie elementów odwrotnych.

\theoremstyle{definition}
\begin{definition}
	Niepusty zbiór $I \subseteq R$ nazywamy \textbf{\textit{ideałem pierścienia}} $\langle R, \oplus, \odot \rangle$, jeśli
	\begin{itemize}[leftmargin=.5in]
		\item $\langle I, \oplus \rangle$ jest podgrupą $\langle R, \oplus \rangle$ oraz
		\item $\forall_{i \in I, r \in R} \: ir \in I \wedge ri \in I $.
	\end{itemize}
\end{definition}

Oczywistymi przykładami ideału dla dowolnego pierścienia $\langle R, \oplus, \odot \rangle$ są zbiory $R$ oraz $\{0\}$. Dla pierścienia $\langle \mathbb{Z}, +, \cdot \rangle$ ideałami będą też wszystkie zbiory liczb podzielnych przez pewne $n \in \mathbb{N}_+$.

\theoremstyle{theorem}
\begin{theorem}
	Jeśli $\langle R, \oplus, \odot \rangle$ jest pierścieniem przemiennym oraz $1 \in R$, to dla $a \in R$ zbiór $\langle a \rangle = \{ ar \, | \, r \in R  \}$ jest jego ideałem. Taki ideał nazywamy \textit{\textbf{ideałem głównym}} generowanym przez element $a$.
\end{theorem}

\begin{proof}
	Aby udowodnić, że $I = \langle a \rangle$ ($a \in R$) jest ideałem $\langle R, \oplus, \odot \rangle$, należy pokazać, że 
	\begin{enumerate}[label=\arabic*., leftmargin=.4in]
		\item $\langle I, \oplus \rangle$ jest podgrupą $\langle R, \oplus \rangle$ oraz 
		\item $\forall_{i \in I, r \in R} \, ir \in I \wedge ri \in I $.
	\end{enumerate}
	\begin{enumerate}[label={Ad.\arabic*.}, leftmargin=.4in]
		\item Pokażemy kolejno, że
		      \begin{enumerate}[label=1.\arabic*., leftmargin=.4in] 
		      	\item istnieje element zerowy w $I$, 
		      	\item $I$ jest zamknięte na $\oplus$ oraz 
		      	\item dla każdego elementu istnieje w $I$ element przeciwny.
		      \end{enumerate}
		      \begin{enumerate}[label=Ad.1.\arabic*]
		      	\item Wiemy, że $0 \in R$, więc $a0=0 \in I$.
		      	\item Weźmy dowolne $i_1, i_2 \in I$. Istnieją takie $r_1, r_2 \in R$, że $i_1 = ar_1$ oraz $i_2 = ar_2$. Stąd $i_1 \oplus i_2 = (ar_1) \oplus (ar_2)$. Z własności pierścienia $\langle R, \oplus, \odot \rangle$ mamy $(ar_1) \oplus (ar_2) = a(r_1 \oplus r_2)$, więc $i_1 \oplus i_2 \in I$, czyli $I$ jest zamknięty na $\oplus$.
		      	\item Weźmy dowolne $i = ar \in I, r \in R$. Istnieje $-r \in R$, więc $a(-r) \in I$. Wiemy, że $i \oplus a(-r) = ar \oplus a(-r) = a(r \oplus -r) = a0 = 0$, więc $a(-r) \in I$ jest elementem przeciwnym $i$.
		      \end{enumerate}
		\item Weźmy dowolne $i = ar_1 \in I, \, r \in R$. Wtedy $ir = ar_1r = a(r_1r)$, więc $ir \in I$. Z przemienności pierścienia $\langle R, \oplus, \odot \rangle$ mamy $ri = ir$, więc $ri \in I$.
	\end{enumerate}
\end{proof}

\theoremstyle{definition}
\begin{definition}
	Ideał $M$ w pierścieniu $R$ nazywamy \textit{\textbf{ideałem maksymalnym}}, jeśli dla każdego ideału $I$ nad $R$ zachodzi $M \subseteq I \Rightarrow I = R$.
\end{definition}

Dla poprzedniego przykładu ideałów w pierścieniu $\langle \mathbb{Z}, +, \cdot \rangle$ ideałami maksymalnymi będą zbiory liczb podzielnych przez liczbę pierwszą.

Przypomnijmy sobie pojęcia teorii grup potrzebne do zdefiniowania grupy ilorazowej.
% \theoremstyle{definition}
\begin{reminder*}
	Podgrupę $\langle N, \odot \rangle$ grupy $\langle G, \odot \rangle$ nazywamy \textit{\textbf{podgrupą normalną}}, jeśli $\forall_{g \in G} \, gN = Ng$, gdzie $gN = \{gn \, | \, n \in N\}$ oraz $Ng = \{ng \, | \, n \in N\}$.
\end{reminder*}

\begin{reminder*}
	Niech $\langle H, \odot \rangle$ będzie podgrupą grupy $\langle G, \odot \rangle$ oraz $g \in G$. Wtedy zbiór 
	$L = gH = \{gh \, | \, h \in H\}$ nazywamy \textbf{\textit{warstwą lewostronną}} oraz zbiór $R = Hg = \{hg \, | \, h \in H\}$ nazywamy \textbf{\textit{warstwą prawostronną}} grupy $G$ względem $\langle H, \odot \rangle$ wyznaczonymi przez $g$.
\end{reminder*}

Możemy teraz przedstawić analogię między ideałem a podgrupą normalną w sposób formalny.

\begin{lemma}
	Ideał $I$ pierścienia $\langle R, \oplus, \odot \rangle$ z działaniem $\oplus$ jest podgrupą normalną grupy $\langle R, \oplus \rangle$.
\end{lemma}

\begin{proof}
	Z definicji ideału wiemy, że $\langle I, \oplus \rangle$ jest podgrupą $\langle R, \oplus \rangle$. \newline
	Należy pokazać, że dla dowolnego $r \in R$ zachodzi $r \oplus I = I \oplus r$. Wiemy, że $\oplus$ jest przemienna, więc mamy ${\{r \oplus i \, | \, i \in I, r \in R\}} = {\{i \oplus r \, | \, i \in I, r \in R\}}$, czyli $r \oplus I = I \oplus r$.
\end{proof}

Zdefiniujmy więc pojęcie grupy ilorazowej, które stanie się podstawą definicji pierścienia ilorazowego.

\theoremstyle{theorem}\label{grup_ilo}
\begin{theorem}
	Jeśli $\langle G, \odot \rangle$ jest grupą, a $\langle N, \odot \rangle$ jej podgrupą normalną, to zbiór warstw grupy $G$ względem $N$ z działaniem $\otimes$ zdefiniowanym jako $(aN)\otimes(bN) = abN$ tworzy grupę. Grupę tę oznaczamy $G/N$ i nazywamy \textbf{\textit{grupą ilorazową}}.
\end{theorem}

\begin{proof}
	Wystarczy pokazać, że 
	\begin{enumerate}[label=\arabic*., leftmargin=.4in]
		\item działanie jest dobrze zdefiniowane, czyli \[\forall_{a, b, c, d \in G/N} \, a = b \wedge c = d \Rightarrow ac = bd\] oraz 
		\item $G/N$ z wyżej zdefiniowanym działaniem jest grupą.
	\end{enumerate}
	\begin{enumerate}[label=Ad.\arabic*., leftmargin=.4in]
		\item Weźmy $aN = bN \in G/N$ oraz $cN = dN \in G/N$. Chcemy pokazać, że $(aN)(cN) = (bN)(dN)$. Wiemy, że, skoro $\langle N, \odot \rangle$ jest grupą, istnieje element neutralny $1 \in N$. Stąd wiemy, że $a = a1 \in aN$ oraz $b = b1 \in bN$. Z $aN = bN$ mamy $b \in aN$. Istnieje więc $n_1 \in N$ takie, że $an_1 = b$. Analogicznie, istnieje $n_2 \in N$ takie, że $cn_2 = d$.\newline
		      \newline
		      Możemy zauważyć, że dla dowolnego $n \in N$ zachodzi $nN = N$. Własność ta wynika bezpośrednio z faktu, że $N$ jest zamknięty na $\odot$.\newline
		      \newline
		      Korzystając z powyższej obserwacji oraz faktu, że $\langle N, \odot \rangle$ jest podgrupą normalną mamy $(bN)(dN) = bdN = an_1cn_2N = an_1cN = an_1Nc = aNc = acN$.\newline
		\item Pokażemy kolejno
		      \begin{enumerate}[label=2.\arabic*.]
		      	\item zamkniętość $G/N$ na $\otimes$, 
		      	\item łączność $\otimes$, 
		      	\item istnienie elementu neutralnego w $G/N$ oraz 
		      	\item istnienie elementów odwrotnych.
		      \end{enumerate}
		      \begin{enumerate}[label=Ad.2.\arabic*.]
		      	\item Weźmy dowolne $aN, \, bN \in G/N$. Mamy $(aN)\otimes(bN) = abN$. $ab \in G$, więc $abN \in G/N$.
		      	\item Weźmy dowolne $aN, \, bN, \, cN \in G/N$. Korzystając z łączności $\odot$ i faktu, że N jest normalna ($cN = Nc$), mamy 
		      	      \begin{align}
		      	      	aN\otimes((bN)\otimes(cN)) & = aN\otimes(bcN) = a(bc)N = (ab)cN \\
		      	      	                           & = (ab)Nc = (abN)\otimes cN         \\
		      	      	                           & = ((aN)\otimes(bN))\otimes cN.     
		      	      \end{align}
		      	\item Weźmy $1N \in G/N$, gdzie $1$ jest elementem neutralnym w $\langle G, \odot \rangle$. Dla dowolnego $aN \in G/N$ mamy $(aN)\otimes(1N) = a1N = aN$, zatem $1N$ jest elementem neutralnym w $G/N$.
		      	\item Weźmy dowolne $aN \in G/N$. Niech $a^{-1}$ będzie elementem odwrotnym $a$ w grupie $\langle G, \odot \rangle$. Mamy \[(aN)(a^{-1}N) = aa^{-1}N = 1N,\] czyli element odwrotny w $G/N$.
		      \end{enumerate}
	\end{enumerate}
\end{proof}

Znając już definicję grupy ilorazowej, możemy ją wykorzystać do zdefiniowania pierścienia ilorazowego. Jest on analogicznie zbiorem warstw względem ideału z odpowiednio zdefiniowanymi działaniami.

\begin{theorem}
	Niech $I$ będzie ideałem pierścienia przemiennego $\langle R, \oplus, \odot \rangle$, a operacje $+$ i $\times$ zdefiniowane będą jako: 
	\begin{itemize}[leftmargin=.4in]
		\item $(r \oplus I) \times (s \oplus I) = (r \odot s) \oplus I$ oraz
		\item $(r \oplus I) + (s \oplus I) = (r \oplus s) \oplus I$.
	\end{itemize}
	Wtedy $\langle R/I, +, \times \rangle$ jest pierścieniem przemiennym. Pierścień taki nazywamy \textbf{\textit{pierścieniem ilorazowym}}.
\end{theorem}

% SPRAWDZONE DOTĄD

\begin{proof}
	$\langle I, \oplus \rangle$ jest podgrupą normalną $\langle R, \oplus \rangle$, więc z Twierdzenia \ref{grup_ilo} $\langle R/I, + \rangle$ jest grupą ilorazową. Wystarczy zatem pokazać, że 
	\begin{enumerate}[label=\arabic*.,leftmargin=.4in]
		\item $\times$ jest dobrze zdefiniowana, tzn. dla $a, b, c, d \in R/I$ jeśli $a = b$ oraz $c = d$, to $a \times c = b \times d$ oraz 
		\item $\langle R/I, +, \times \rangle$ jest pierścieniem przemiennym.
	\end{enumerate}
	\begin{enumerate}[label=Ad.\arabic*.,leftmargin=.4in]
		\item Weźmy dowolne $a, b, c, d \in R$ takie, że $a \oplus I = b \oplus I$ oraz $c \oplus I = d \oplus I$. Wiemy, że $\langle I, \oplus \rangle$ jest grupą, więc zawiera element neutralny $e$. Stąd $a \oplus e = a \in a \oplus I = b \oplus I$. Istnieje więc $i_1 \in I$ taki, że $a = b \oplus i_1$. Analogicznie istnieje $i_2 \in I$ takie, że $c = d \oplus i_2$. \newline
		      $\langle I, \oplus \rangle$ jest grupą, więc dla dowolnego $i \in I$ $i \oplus I = I$. \newline
		      Mamy więc $(a \oplus I) \times (c \oplus I) = a \odot c \oplus I = (b \oplus i_1) \odot (d \oplus i_2) \oplus I$. Jako że $b, d, i_1, i_2 \in R$ oraz $\langle R, \oplus, \odot \rangle$ jest pierścieniem mamy $(b \oplus i_1) \odot (d \oplus i_2) \oplus I = b \odot d \oplus b \odot i_2 \oplus i_2 \odot d \oplus i_1 \odot i_2 \oplus I$. $I$ jest ideałem, więc $b \odot i_2, i_1 \odot d, i_1 \odot i_2 \in I$. Stąd $b \odot d \oplus b \odot i_2 \oplus i_2 \odot d \oplus i_1 \odot i_2 \oplus I = b \odot d \oplus I = (b \oplus I) \times (d \oplus I)$.
		\item Pokażemy, że $\langle R/I, +, \times \rangle$ spełnia warunki z definicji pierścienia przemiennego.
		      \begin{itemize}	    
		      	\item + jest przemienna. Weźmy dowolne $a \oplus I, b \oplus I \in R/I$. Z przemienności $\oplus$ w pierścieniu $\langle R, \oplus, \odot \rangle$ mamy $(a \oplus I) + (b \oplus I) = (a \oplus b) \oplus I = (b \oplus a) \oplus I = (a \oplus I) + (b \oplus I)$.
		      	\item + jest łączna. Weźmy dowolne $a \oplus I, b \oplus I, c \oplus I \in R/I$. Z łączności $\oplus$ w $\langle R, \oplus, \odot \rangle$ mamy $((a \oplus I) + (b \oplus I)) + (c \oplus I) = (a \oplus b \oplus I) + (c \oplus I) = (a \oplus b) \oplus c \oplus I = a \oplus (b \oplus c) \oplus I = (a \oplus I) + (b \oplus c \oplus I) = (a \oplus I) + ((b \oplus I) + (c \oplus I))$.
		      	\item Istnieje element zerowy. Niech $0_I = 0_R \oplus I$, gdzie $0_R$ jest elementem zerowym pierścienia $\langle R, \oplus \rangle$. Weźmy dowolne $a \oplus I \in R/I$. Wtedy $(a \oplus I) + 0_I = a \oplus 0_R \oplus I = (a \oplus I) = 0_R \oplus a \oplus I = 0_I + (a \oplus I)$.
		      	\item Dla każdego elementu istnieje element odwrotny. Weźmy dowolne $a \oplus I \in R/I$. Istnieje $-a \in R$, będące elementem odwrotnym $a$. $(a \oplus I) + (-a \oplus I) = a \oplus -a \oplus I = 0_R \oplus I = 0_I = -a \oplus a \oplus I = (-a \oplus I) + (a \oplus I)$.
		      	\item $\times$ jest łączna. Weźmy dowolne $a \oplus I, b \oplus I, c \oplus I \in R/I$. Z łączności $\odot$ w pierścieniu $\langle R, \oplus, \odot \rangle$ mamy $((a \oplus I) \times (b \oplus I)) \times (c \oplus I) = (a \odot b \oplus I) \times (c \oplus I) = (a \odot b) \odot c \oplus I = a \odot (b \odot c) \oplus I = (a \oplus I) \times (b \odot c \oplus I) = (a \oplus I) \times ((b \oplus I) \times (c \oplus I))$.
		      	\item + jest rozdzielna względem $\times$. Weźmy dowolne $a \oplus I, b \oplus I, c \oplus I \in R/I$. Z rozdzielności $\oplus$ względem $\odot$ w pierścieniu $\langle R, \oplus, \odot \rangle$ mamy $(a \oplus I) \times ((b \oplus I) + (c \oplus I)) = a \odot (b \oplus c) \oplus I = a \odot b \oplus a \odot c \oplus I = ((a \oplus I) \times (b \oplus I)) + ((a \oplus I) \times (c \oplus I))$ oraz $((a \oplus I) + (b \oplus I)) \times (c \oplus I) = (a \oplus b) \odot c \oplus I = a \odot c \oplus b \odot c \oplus I = ((a \oplus I) \times (c \oplus I)) + ((b \oplus I) \times (c \oplus I))$.
		      	\item $\times$ jest przemienna. Weźmy dowolne $a \oplus I, b \oplus I \in R/I$. Z przemienności $\odot$ w pierścieniu $\langle R, \oplus, \odot \rangle$ mamy $(a \oplus I) \times (b \oplus I) = a \odot b \oplus I = b \odot a \oplus I = (b \oplus I) \times (a \oplus I)$.
		      \end{itemize}
	\end{enumerate}
\end{proof}

Możemy zauważyć, że ideał w teorii pierścieni odpowiada podgrupie normalnej w teorii grup. Co więcej, analogia ta aplikuje się także do konstrukcji pierścienia ilorazowego. Ideał pełni bowiem w konstrukcji pierścienia ilorazowego taką rolę, jaką w konstrukcji grupy ilorazowej pełni podgrupa normalna.

Mając już definicję pierścienia ilorazowego, możemy pokazać, że pewne pierścienie ilorazowe są ciałami. Będzie to twierdzenie, którego będziemy używać w późniejszych lematach dla pierścienia ilorazowego pierścienia wielomianów.

\theoremstyle{theorem}
\begin{theorem}\label{pier_ilo_cialem0}
	Jeśli $\langle R, \oplus, \odot \rangle$ jest pierścieniem przemiennym z elementem neutralnym mnożenia $1$, a $M$ ideałem maksymalnym nad R, to $R/M$ z działaniami zdefiniowanymi jak w powyższych twierdzeniach jest ciałem.
\end{theorem}

\begin{proof}
	Wiemy, że $R/M$ jest pierścieniem przemiennym. Wystarczy pokazać, że w $R/M$
	\begin{enumerate}[label=\arabic*.,leftmargin=.4in]
		\item istnieje element neutralny mnożenia oraz 
		\item dla każdego niezerowego elementu istnieje element odwrotny.
	\end{enumerate}
	\begin{enumerate}[label=Ad.\arabic*.,leftmargin=.4in]
		\item Dla dowolnego $a \oplus M \in R/M$ mamy
		      $(a \oplus M) \times (1 \oplus M) = a \odot 1 \oplus M = a \oplus M = 1 \odot a \oplus M = (1 \oplus M) \times (a \oplus M)$. Zatem $1 \oplus M$ jest elementem neutralnym mnożenia w $R/M$.
		\item Weźmy dowolne $a \in R$ takie, że $a \oplus M$ jest niezerowe, czyli $a \notin M$. Weźmy zbiór $J = \{ra \oplus m \, | \, r \in R, m \in M\}$. Pokażemy, że $J$ jest ideałem nad $R$. W tym celu wystarczy pokazać, że 
		      \begin{enumerate}[label=2.\arabic*.]
		      	\item $\langle J, \oplus \rangle$ jest podgrupą $\langle R, \oplus \rangle$ oraz 
		      	\item $\forall_{j \in J, r \in R} \, jr \in J \wedge rj \in J$.
		      \end{enumerate}
		      \begin{enumerate}[label=Ad.2.\arabic*.]
		      	\item Udowodnimy, że $\langle J, \oplus \rangle$ spełnia definicję grupy oraz zawiera się w $\langle R, \oplus \rangle$.
		      	      \begin{itemize}
		      	      	\item Wiemy, że $R$ jest zamknięty na $\oplus$ i $\odot$, więc $\forall_{r, a', m \in R} \, ra' \oplus m \in R$ i $J \subseteq R$. 
		      	      	\item $M$ jest ideałem, czyli jest grupą, więc $0 \in M$. Stąd $0a \oplus 0 = 0 \in J$, czyli $J$ zawiera element zerowy.
		      	      	\item Weźmy dowolne $j = ra \oplus m \in J$. Wiemy, że $-r \in R$ oraz $-m \in M$. Stąd $-j = -ra \oplus -m \in J$. Wtedy $j \oplus -j = ra \oplus m \oplus -ra \oplus -m = ra \oplus -ra = 0a = 0$, tzn. dla każdego elementu $J$ istnieje element przeciwny.
		      	      	\item Weźmy dowolne $j_1 = r_1a \oplus m_1, j_2 = r_2a \oplus m_2 \in J$. Wtedy $j_1 \oplus j_2 = r_1a \oplus m_1 \oplus r_2a \oplus m_2 = (r_1 \oplus r_2)a \oplus (m_1 \oplus m_2)$. Wiemy, że $r_1 \oplus r_2 \in R$ oraz $m_1 \oplus m_2 \in M$, więc $j_1 \oplus j_2 \in J$, czyli $J$ jest zamknięte na $\oplus$.
		      	      	\item $\oplus$ jest łączne. Własność ta wynika bezpośrednio z łączności $\oplus$ w $R$.
		      	      \end{itemize}
		      	\item Weźmy dowolne $ra \oplus m \in J$ oraz $r' \in R$. Wtedy $jr' = (ra \oplus m) \odot r' = rar' \oplus mr'$. Z przemienności mnożenia w $R$ mamy $jr' = rr'a \oplus mr'$. Z $rr' \in R$ oraz ponieważ $M$ jest ideałem $mr' \in M$, otrzymujemy $jr' \in J$. Analogicznie $r'j \in J$.
		      \end{enumerate}
		      Wiemy, że $J$ jest ideałem nad $R$. Możemy też pokazać, że $M \subset J$. Skoro $\forall_{m \in M} \, m = 0a \oplus m \in J$ oraz $1 \in R$ i $0 \in M$, to $a \in J$. Wiemy, że $a \notin M$, więc $M \subset J$.
		      \newline
		      Mamy więc ideał $J$ nad $R$, który zawiera $M$. Z założenia, że $M$ jest maksymalny, mamy $J = R$, więc $1 \in J$, czyli $\exists_{m \in M, r \in R} \, ra \oplus m = 1$. Wtedy $(r \oplus M) \times (a \oplus M) = ra \oplus M = ra \oplus m \oplus M = 1 \oplus M$, czyli $(a \oplus M)^{-1} = r \oplus M$.
	\end{enumerate}   
	    
\end{proof}

\section{Pierścień wielomianów}

Następnym krokiem we wprowadzeniu pojęć algebry abstrakcyjnej będzie bliższe przyjrzenie się pierścieniom wielomianów. W dowodach będziemy korzystać z twierdzeń i lematów z poprzedniej sekcji. Przechodząc w przestrzeń wielomianów będziemy w stanie zaaplikować twierdzenia algebry abstrakcyjnej do równości uogólnionego Małego Twierdzenia Fermata dla wielomianów, które jest bezpośrednio wykorzystane w algorytmie AKS.

Spójrzmy na pierścień liczb całkowitych modulo liczba naturalna. Na podstawie poniższego twierdzenia będziemy mogli powiązać pierwszość liczby z jego własnościami.

\begin{theorem}
	Niech $p \in \mathbb{N}$ i $p \geq 2$ oraz $\mathbb{Z}_p = \{0, 1, \ldots, p-1\}$. Wówczas jeśli $p$ jest pierwsza, to $\langle \mathbb{Z}_p, +_p, \times_p \rangle$, gdzie operacje są $+_p$ i $\times_p$ odpowiadającymi działaniami arytmetycznymi modulo $p$, jest ciałem.
\end{theorem}

\begin{proof}
	Pokażemy, że jeśli $p$ jest pierwsza, $\langle \mathbb{Z}_p, +_p, \times_p \rangle$ spełnia Definicję \ref{cialo}.
	\begin{enumerate}[label=\arabic*.,leftmargin=.4in]
		\item $\langle \mathbb{Z}_p, +_p, \times_p \rangle$ z $1$ jest pierścieniem. Dowód jest trywialny i korzysta z własności działań $+_p$ i $\times_p$.
		\item Należy więc pokazać, że $\langle \mathbb{Z}_p \setminus \{0\}, \times_p \rangle$ jest grupą abelową. Przemienność i łączność wynikają z własności $\times_p$. Elementem neutralnym jest $1$. Jedyną nietrywialną własnością jest istnienie elementu przeciwnego, tzn. należy udowodnić, że $\forall_{a \in \mathbb{Z}_p \setminus \{0\}} \, \exists_{a^{-1} \in \mathbb{Z}_p \setminus \{0\}} \, a \times_p a^{-1} = 1$.\newline
		      Weźmy dowolne $a \in \mathbb{Z}_p \setminus \{0\}$. Załóżmy nie wprost, że nie istnieje $a^{-1} \in \mathbb{Z}_p \setminus \{0\}$ takie, że $a \times_p a^{-1} = 1$. To znaczy $\forall_{b \in \mathbb{Z}_p \setminus \{0\}} \, a \times_p b \neq 1$. Ponieważ $p$ jest pierwsze i wszystkie elementy $\mathbb{Z}_p \setminus \{0\}$ są mniejsze od $p$, wiemy, że $\forall_{b \in \mathbb{Z}_p \setminus \{0\}} \, a \times_p b \neq 0$. Mamy więc $p-1$ czynników $b$ i $p-2$ możliwych wyników $a \times_p b$. Z zasady szufladkowej mamy $\exists_{b_1, b_2 \in \mathbb{Z}_p \setminus \{0\}}, b_1 \neq b_2 \, a \times_p b_1 = a \times_p b_2$. Otrzymujemy $a \times_p (b_1 -_p b_2) = 0$, czyli doszliśmy do sprzeczności.
	\end{enumerate}
\end{proof}

\begin{theorem}
	Niech $\langle R, \oplus, \odot \rangle$ będzie pierścieniem przemiennym z $1$ oraz $R[X]$ będzie zbiorem wielomianów o współczynnikach w $R$, a $\oplus^*$ i $\odot^*$ będą naturalnie zdefiniowanym dodawaniem i mnożeniem wielomianów z użyciem $\oplus$ i $\odot$ w operacjach na współczynnikach. Wówczas
	$\langle R[X], \oplus^{*}, \odot^{*} \rangle$ jest pierścieniem przemiennym z elementem neutralnym mnożenia będącym wielomianem stałym $1$.
\end{theorem}

\begin{remark*}
    Pomijamy dowód twierdzenia, ponieważ jest on standardowy. Przebiega on przez pokazanie kolejnych własności pierścienia.
\end{remark*}

Przyjrzyjmy się następnie bliżej pierścieniowi wielomianów, którego współczynniki są elementami ciała. Poniższe lematy pozwolą na ustalenie, kiedy pierścień ilorazowy takiego pierścienia jest ciałem, co stanie się podstawą dowodu algorytmu AKS.

\begin{lemma}\label{idealy_glowne0}
	Jeśli $\langle F, \oplus, \odot, 0, 1 \rangle$ jest ciałem, to wszystkie ideały nad $F[X]$ są ideałami głównymi.
\end{lemma}

\begin{proof}
    Weźmy dowolny ideał $I$ nad $F[X]$. Jeśli $I = \{0\}$, to $I = \langle0\rangle$. Załóżmy więc, że $I \neq \{0\}$ i weźmy $p(X) \in I$ takie, że $p(X) \neq 0$ oraz $p(X)$ jest wielomianem najmniejszego stopnia w $I$. Weźmy dowolny wielomian $f(X) \in I$. Jeśli w wyniku jego podzielenia przez $p(X)$ daje resztę $r(X)$, to możemy go przedstawić jako $f(X) = q(X)p(X) \oplus r(X)$, gdzie $deg(r) < deg(p)$. Zauważmy, że $r(X) \in I$, a więc i $q(X)p(X) \in I$. Z założenia o minimalnym stopniu $p(X)$ mamy $r(X) = 0$. Oznacza to, że dowolny wielomian z $I$ da się przedstawić w postaci $q(X)p(X)$, więc $I = \langle p(X) \rangle$. 
\end{proof}

\begin{theorem}
	Jeśli $\langle F, \oplus, \odot, 0, 1 \rangle$ jest ciałem i wielomian $g(X)$ jest nierozkładalny w $F[X]$, to $\langle g(X) \rangle$ jest ideałem maksymalnym.
\end{theorem}

\begin{proof}
	Weźmy dowolny ideał $I$ nad $F[X]$. Wiemy, że jest to ideał główny, więc istnieje $f(X) \in F[X]$ takie, że $I = \langle f(X) \rangle$. Załóżmy, że $\langle g(X) \rangle \subset I$. Znaczy to, że istnieje $h(X) \in F[X]$ takie, że $g(X) = f(X)h(X)$. Z założenia $g(X)$ jest nierozkładalny, więc $f(X)$ lub $h(X)$ jest wielomianem stopnia $0$. Jeśli $f(X)$ jest stopnia $0$, to $\langle f(X) \rangle = F$. Jeśli $h(X)$ jest stopnia $0$, to $\langle g(X) \rangle = \langle h(X) \rangle$, co jest sprzeczne z założeniem.
\end{proof}

Możemy w szczególności zaaplikować powyższe twierdzenia do ciała liczb całkowitych modulo liczba pierwsza.

\begin{theorem} \label{pier_ilo_cialem}
	Jeśli $p$ jest liczbą pierwszą i $h(X)$ jest nierozkładalnym w $\mathbb{Z}_p[X]$ wielomianem stopnia $d$, to pierścień ilorazowy $\langle \mathbb{Z}_p[X]/\langle h(X) \rangle, \oplus, \odot \rangle$, gdzie $\oplus$ i $\odot$ są naturalnie zdefiniowanymi operacjami na wielomianach, jest ciałem rzędu $p^d$.
\end{theorem}

\begin{proof}
	Pokażemy kolejno, że 
	\begin{enumerate}[label=\arabic*.,leftmargin=.4in]
		\item pierścień $\langle \mathbb{Z}_p[X]/\langle h(X) \rangle, \oplus, \odot \rangle$ jest ciałem oraz
		\item jest ono rzędu $p^d$.
	\end{enumerate}
	\begin{enumerate}[label=Ad.\arabic*.,leftmargin=.4in]
		\item $\langle \mathbb{Z}_p, +_p, \times_p, 0, 1 \rangle$ jest ciałem, a $h(X)$ jest nierozkładalny w pierścieniu $\langle \mathbb{Z}_p[X], +^*, \times^* \rangle$, więc na mocy Twierdzenia \ref{pier_ilo_cialem0}$\langle \mathbb{Z}_p[X]/\langle h(X) \rangle, \oplus, \odot \rangle$ jest ciałem.
		\item Niech $M = \langle h(X) \rangle$. Pokażemy, że jeśli wielomiany $f(X), g(X) \in \mathbb{Z}_p[X]$, gdzie 
		      \begin{align*}
		      	f(X) & = h(X)q_1(X) +^* r_1(X), \\
		      	g(X) & = h(X)q_2(X) +^* r_2(X), 
		      \end{align*}
		      oraz $r_1(X) = r_2(X)$, to 
		      \begin{align*}
		      	f(X) +^* M = g(X) +^* M. 
		      \end{align*}
		      Mamy 
		      \begin{align*}
		      	f(X) +^* M & = h(X)q_1(X) +^* r_1(X) +^* M  \\
		      	           & = r_1(X) +^* h (X)q_1(X) +^* M \\
		      	           & = r_1(X) +^* M                 \\
		      	           & = r_2(X) +^* M                 \\
		      	           & = r_2(X) +^* h(X)q_2(X) +^* M  \\
		      	           & = g(X) +^* M.                  
		      \end{align*}
		      Ponadto wiemy, że, ponieważ $M$ jest ideałem głównym, dowolna para wielomianów $f(X), g(X) \in r(X) +^* M$ ma taką samą resztę z dzielenia przez $h(X)$. Mamy więc wniosek, że para wielomianów należy do tego samego elementu zbioru $\mathbb{Z}_p[X]/\langle h(X) \rangle$ wtw, gdy mają taką samą resztę z dzielenia przez $h(X)$.\newline
		      Mamy więc tyle elementów zbioru $\mathbb{Z}_p[X]/\langle h(X) \rangle$, ile jest różnych reszt dzielenia wielomianu przez $h(X)$, czyli też tyle, ile jest wielomianów stopnia $d-1$ w $\mathbb{Z}_p[X]$. Stąd $ord(\mathbb{Z}_p[X]/\langle h(X) \rangle) = p^d$.
	\end{enumerate}
\end{proof}

\section{Pierwiastki z jedności, wielomiany cyklotomiczne}

Kolejną grupą twierdzeń potrzebnych do udowodnienia poprawności algorytmu AKS są twierdzenia związane z pierwiastkami jedności nad ciałem. Aby uprościć późniejsze rozważania, wprowadźmy następujące pojęcia związane z ciałami.

\begin{remark*}
    Ponieważ w tej i kolejnych sekcjach rozważane w kontekście pewnego ciała operacje i ich elementy neutralne będą oczywiste, dla uproszczenia będziemy oznaczać jako $F$ ciało $\langle F, +, \cdot, 0, 1 \rangle$.    
\end{remark*}

\begin{definition}
	\textbf{\textit{Charakterystyką}} ciała $F$ będziemy nazywać najmniejszą taką liczbę naturalną $char(F) = n$, że suma $n$ jedności równa się zeru w $F$.
\end{definition}

\begin{definition}
	\textit{\textbf{Podciałem}} ciała $F$ nazywamy takie $G \subseteq F$, że $G$ z działaniami z $F$ ograniczonymi do elementów $G$ jest ciałem.
\end{definition}
	
\begin{definition}
	\textit{\textbf{Rozszerzeniem ciała}} $F$ nazywamy takie ciało $G$, że $F$ jest podciałem $G$.
\end{definition}

Zauważmy, że ciało liczb zespolonych jest rozszerzeniem ciała liczb rzeczywistych. Bardziej interesującym przykładem w dalszej części wywodu będzie jednak rozszerzenie ciał skończonego rzędu. Skorzystamy bowiem z własności, że jeśli $p$ jest liczbą pierwszą oraz $f(X)$ jest nierozkładalny w $\mathbb{Z}_p[X]$, to $\mathbb{Z}_p[X]/\langle f(X)\rangle$ jest rozszerzeniem ciała $\mathbb{Z}_p$. Co więcej, umiemy uzasadnić, że $\mathbb{Z}_p$ jest podciałem $\mathbb{Z}_{p^{deg(g)}}$. Niech $d = deg(g)$. Zauważmy, że możemy skonstruować bijekcję między elementami $\mathbb{Z}_p[X]/\langle f(X)\rangle$ i $\mathbb{Z}_p$ zachowującą działania, ich elementy neutralne i odwrotności. Wielomianowi $h(X) = a_0 + a_1X + \ldots + a_{d-1}X^{d-1} \in \mathbb{Z}_p[X]/\langle f(X)\rangle$ odpowiada liczba $a_0p^{d-1} + \ldots + a_{d-1} \in \mathbb{Z}_{p^d}$. Wówczas $\mathbb{Z}_p$ jest podciałem $\mathbb{Z}_{p^d}$ w taki sposób, że elementowi $k \in \mathbb{Z}_p$ odpowiada $kp^{d-1} \in \mathbb{Z}_{p^d}$.

% Widoczna jest w tym wypadku analogia z pierwszym przykładem.
\begin{observation}\label{char1}
	Jeśli ciało $G$ jest rozszerzeniem ciała $F$, to $char(G)=char(F)$.
\end{observation}
	
\begin{remark*}
	Jako $F(a_1, \, \dots,\, a_n)$ będziemy oznaczać najmniejsze rozszerzenie ciała $F$ zawierające $a_1, \, \dots,\, a_n$.
\end{remark*}
	
\begin{definition}
	\textit{\textbf{Ciałem rozkładu}} wielomianu $f(X) \in F[X]$ nad $F$ nazywamy $G$ będące rozszerzeniem $F$ takie, że $f(X)$ można rozłożyć na czynniki liniowe w pierścieniu $G[X]$.
\end{definition}

Jako że ciało rozkładu wielomianu będzie ważnym pojęciem w kolejnych deifnicjach, pokażmy, że takowe zawsze istnieje. 
	
\begin{lemma}[Twierdzenie Kroneckera] \label{Kronecker}
	Dla każdego ciała $F$ i wielomianu $f(X) \in F[X], deg(f) \geq 2$ istnieje rozszerzenie $G$ ciała $F$, w którym $f(X)$ ma pierwiastek.
\end{lemma}
	
\begin{proof}
	Niech $h(X) = a_0 + a_1X + \dots + a_nX^n$ będzie nierozkładalnym w $F[X]$ czynnikiem $f(X)$. Z Twierdzenia \ref{pier_ilo_cialem} 
	wiemy, że $F[X]/\langle h(X) \rangle$ jest ciałem, a co więcej jest rozszerzeniem $F$.\newline
	Niech $\alpha = X + \langle h(X)\rangle$. Ponieważ $deg(f) \geq 2$, $\alpha \in F[X]/\langle h(X) \rangle$. Mamy więc 
	\begin{align*}
		h(\alpha) & = a_0 + a_1(X + \langle h(X)\rangle) + \dots + a_n(X+\langle h(X)\rangle)^n \\
		          & = h(X) + \langle h(X) \rangle = 0                                           
	\end{align*}
	w $F[X]/\langle h(X) \rangle$, czyli $\alpha$ jest pierwiastkiem $f(X)$.
\end{proof}

% Mając już potrzebne terminy wprowadźmy
	
\begin{theorem}
	Dla każdego ciała $F$ i wielomianu $f(X) \in F[X], \, deg(f) \geq 1$ istnieje ciało rozkładu $f(X)$ nad $F$.
\end{theorem}
	
\begin{proof}
	Dowód przebiegać będzie przez indukcję względem $n = deg(f)$. Przypadek dla $n = 1$ jest trywialny, ponieważ $F$ spełnia warunki. Załóżmy więc $deg(f) \geq 2$ oraz, że dla wszystkich wielomianów niższego stopnia teza zachodzi. Z Lematu \ref{Kronecker} wiemy, że istnieje ciało $G$ będące rozszerzeniem $F$ takie, że istnieje $\alpha \in G, \, f(\alpha) = 0$. Mamy więc w $G[X]$ równość $f(X) = (X - \alpha)g(X)$. Z założenia indukcyjnego wiemy, że dla $g(X)$ istnieje ciało rozkładu $H$ nad $G$ więc $H$ jest też ciałem rozkładu $f(X)$ nad $F$.
\end{proof}
	
\begin{definition}
	Niech $F$ będzie ciałem i $n \in \mathbb{N}_+$. Ciało rozkładu  wielomianu $X^n - 1$ nad $F$ będziemy nazywać \textit{\textbf{n-tym ciałem cyklotomicznym}} i oznaczać $F^{(n)}$, a zbiór pierwiastków $X^n - 1$ w $F^{(n)}$ \textit{\textbf{pierwiastkami n-tego stopnia z jedności}} i oznaczać $E^{(n)}$.
\end{definition}
	
\begin{theorem} \label{mult_root}
	Niech $F$ będzie ciałem i $f(X) \in F[X]$. Jeśli $a \in F$ jest wielokrotnym pierwiastkiem $f(X)$, to jest też pierwiastkiem $f'(X)$.
\end{theorem}
	
\begin{proof}
	Zauważmy, że, ponieważ $f(X)$ jest wielomianem, $f(X) \in F[X]$ implikuje $f'(X) \in F[X]$. Skoro $f(X)$ ma co najmniej podwójny pierwiastek w $a$, to istnieje $h(X) \in F[X]$ takie, że $f(X) = (X - a)(X - a)h(X)$. Wtedy $f'(X) = (X - a)((X - a)h'(X) + 2h(X))$, czyli $f'(X)$ ma pierwiastek w $a$.
\end{proof}

Przyjrzyjmy się strukturze zbioru pierwiastków $n$-tego stopnia z jedności nad ciałem. 
	
\begin{theorem}
	Niech $F$ będzie ciałem i $p = char(F)$. Wówczas zbiór pierwiastków $n$-tego stopnia z jedności $E^{(n)}$, gdzie $n \in \mathbb{N}$ oraz $p \nmid n$ z operacją mnożenia w $K^{(n)}$ jest grupą cykliczną rozmiaru $n$.
\end{theorem}
	
\begin{proof}
    Niech $\cdot$ będzie operacją mnożenia w $K^{(n)}$.
	Pokażemy kolejno, że 
	\begin{enumerate}[label=\arabic*.,leftmargin=.4in]
		\item $|\,E^{(n)}\,| = n$, 
		\item $\langle E^{(n)}, \cdot \rangle$ jest grupą, a co więcej, 
		\item $\langle E^{(n)}, \cdot \rangle$ jest cykliczna.
	\end{enumerate}
	\begin{enumerate}[label=Ad.\arabic*.,leftmargin=.4in]
		\item Przypadek dla $n = 1$ jest trywialny, ponieważ zbiór $E^{(n)}$ jest wtedy zbiorem zawierającym tylko $1$. Załóżmy więc, że $n \geq 2$. Z Twierdzenia \ref{mult_root} wiemy, że jeśli $f(X) = X^n - 1$ i $f'(X) = nX^{n-1}$ nie mają wspólnych pierwiastków w $F$, to nie istnieją w $F$ wielokrotne pierwiastki wielomianu $f(X)$. Z Obserwacji \ref{char1} mamy $char(K^{(n)}) = p$. Z założenia $p \nmid n$. Możemy więc zauważyć, że jedynym pierwiastkiem $f'(X)$ w $F$ jest $0$. Dodatkowo $0$ nie jest pierwiastkiem $f(X)$, więc $f(X)$ ma $n$ różnych pierwiastków w $F$, skąd $|\,E^{(n)}\,| = n$.
		\item Pokażemy zamkniętość $E^{(n)}$ na $\cdot$, istnienie elementu neutralnego i elementów odwrotnych w $E^{(n)}$. Weźmy dowolne $\zeta_1, \zeta_2 \in E^{(n)}$. Niech $\zeta = \zeta_1 \zeta_2$. Wtedy $\zeta^n = (\zeta_1 \zeta_2)^n = \zeta_1^n \zeta_2^n = 1$, czyli $\zeta_1 \zeta_2 \in E^{(n)}$. Dla dowolnego $\zeta \in E^{(n)}$ istnieje element odwortny $\zeta^{n-1} \in E^{(n)}$. Element neutralny stanowi $1_{K^{(n)}}$.
		\item Pokażemy cykliczność $E^{(n)}$ poprzez znalezienie generatora grupy. 
		      \begin{enumerate}[label=Ad.3.\arabic*.]
		      	\item Niech $n$ będzie liczbą pierwszą. Weźmy dowolne $\zeta \in E^{(n)}$. Załóżmy nie wprost, że istnieje $q < n, q \in \mathbb{N}$ takie, że $\zeta^q = 1$. Wtedy $q \, | \, n$, co jest sprzeczne z założeniem o pierwszości $n$. Skoro takie $q$ nie istnieje, to $\zeta$ generuje $E^{(n)}$, ponieważ dla każdego $i, j < n, i, j \in \mathbb{N} \, \zeta^i \neq \zeta^j$.
		      	\item Niech $n = p_1^{e_1} \cdot \ldots \cdot p_r^{e_r}$ będzie rozkładem $n$ na czynniki pierwsze. Dla każdego $1 \leq i \leq r$ istnieje nie więcej niż $\frac{n}{p_i}$ pierwiastków wielomianu $X^{\frac{n}{p_i}}-1$. Ponieważ $\frac{n}{p_1} < n$, istnieje $\zeta_i$ nie będąca pierwiastkiem $X^{\frac{n}{p_i}} - 1$. Niech $\alpha_i = \zeta_i^{\frac{n}{(p_i^{e_i})}}$. Wiemy, że $o_n(\alpha_i) \, | \, p_i^{e_i}$, a ponieważ $p_i$ jest pierwsza, $o_n(\alpha_i) = p_i^s$, gdzie $s \leq e_i$. Zauważmy, że jeśli dla $k < r_i$ zachodzi $\alpha_i^{p_i^k} = 1$, to także $(\alpha_i^{p_i^k})^{p_i} = \alpha_i^{p_i^{k+1}} = 1$. Poprzez indukcję względem $k$ zachodzi $\alpha_i^{p_i^{e_i-1}} = 1$. Wybraliśmy $\alpha$ takie, że $\alpha_i^{p_i^{e_i-1}} = \zeta^{\frac{n}{p_i}} \neq 1$, więc $o_n(\alpha_i) = p_i^{e_i}$. \newline
		      	      Weźmy $\alpha = \alpha_1 \cdot \ldots \cdot \alpha_r$. Pokażemy, że $o_n(\alpha) = n$. Wiemy, że $o_n(\alpha) \, | \, n$. Załóżmy nie wprost, że $o_n(\alpha) \neq n$. Wynika stąd, że istnieje takie $p_i$, że $o_n(\alpha) \, | \, \frac{n}{p_i}$. Wtedy $\alpha^{\frac{n}{p_i}} = 1 = \alpha_1^{\frac{n}{p_i}} \cdot \dots \cdot \alpha_r^{\frac{n}{p_r}}$. Dla każdego $j \neq i, 1 \leq j \leq r$ zachodzi z założenia $p_j^{e_j} \, | \, \frac{n}{p_i}$, a ponieważ $o_n(\alpha_j) = p_i^{e_j}$, mamy $\alpha_j^{\frac{n}{p_i}} = 1$. Mamy więc $\alpha^{\frac{n}{p_i}} = \alpha_i^{\frac{n}{p_i}} = 1$, czyli $o_n(\alpha_i) | \frac{n}{p_i}$. Mamy jednak $o_n(\alpha_i) = p_i^{e_i}$, które nie dzieli $\frac{n}{p_i}$, więc otrzymaliśmy sprzeczność. Pokazaliśmy więc, że $o_n(\alpha) = n$. Na mocy argumentu jak w przypadku, gdy $n$ jest pierwsza, znaleźliśmy $\alpha$ będące generatorem $E^{(n)}$.
		      \end{enumerate}
	\end{enumerate}
\end{proof}
    

\begin{reminder*}
	\textbf{\textit{Funkcją Eulera}} nazywamy taką funkcję $\phi$, że dla $n \in \mathbb{N}, \, n \geq 2$ $\phi(n)$ jest równa liczbie liczb naturalnych $q < n$ takich, że $NWD(n, q) = 1$. 
\end{reminder*}

Możemy teraz wprowadzić pojęcie pierwiastka pierwotnego a następnie wielomianu cyklotomicznego oraz udowodnić kilka związanych z nimi własności, które okażą się pomocne w dalszych dowodach.

\begin{definition}
	Pierwiastek $n$-tego stopnia z jedności nad ciałem $F$ nazywamy \textbf{\textit{pierwotnym}}, jeśli jest generatorem grupy $E^{(n)}$.
\end{definition}
	
\begin{observation}
	Dla każdego ciała $F$ i $n \in \mathbb{N}, \, char(F) \nmid n$  istnieje co najmniej jeden pierwotny pierwiastek z jedności $n$-tego stopnia nad $F$.
\end{observation}
	
\begin{lemma}\label{pierwotne}
	Jeśli $\zeta$ jest pierwotnym pierwiastkiem $n$-tego stopnia nad ciałem $F, char(F) \nmid n$, to dowolne $\zeta^s$, gdzie $s \in \mathbb{N}, \, NWD(s, n) = 1$ także jest pierwotnym pierwiastkiem $n$-tego stopnia nad $F$.
\end{lemma}
	
\begin{proof}
    Weźmy $s$ takie, że $NWD(s, n) = 1$. Załóżmy nie wprost, że istnieje $k < n$ takie, że $(\zeta^s)^k = 1$. Wtedy $\zeta^{sk} = 1$, więc z pierwotności $\zeta$ możemy wywnioskować, że $n \, | \, sk$. Ponieważ $NWD(s, n) = 1$, otrzymujemy $n \, | \, k$, czyli doszliśmy do sprzeczności i $\zeta^s$ jest generatorem grupy.
\end{proof}
	
\begin{definition}
	Niech $F$ będzie ciałem, $n \in \mathbb{N}, \, char(F) \nmid n$ oraz $\zeta$ będzie pierwotnym pierwiastkiem z jedności $n$-tego stopnia nad $F$. Wtedy wielomian \[Q_n(X) = \prod_{s = 1, NWD(s, n) = 1}^{n}(X - \zeta^s)\] nazywamy \textit{\textbf{$n$-tym wielomianem cyklotomicznym}} nad $F$.
\end{definition}
	
\begin{lemma}\label{cyklo_dzieli}
	Jeśli $Q_n(X)$ jest $n$-tym wielomianem cyklotomicznym nad ciałem F, gdzie $n\in \mathbb{N}$, to $Q_n(X) \, | \, X^n - 1$ w F.
\end{lemma}
	
\begin{proof} 
	Własność ta jest oczywista i wynika z zawierania się zbioru pierwiastków $Q_n(X)$ w zbiorze pierwiastków wielomianu $X^n - 1$.
\end{proof}
	
\begin{observation}
	$Q_n(X)$ nie zależy od wyboru $\zeta$ oraz jest stopnia $\phi(n)$. Dodatkowo z definicji $K^{(n)}$ wiemy, że współczynniki $Q_n(X)$ należą do $K^{(n)}$.
\end{observation}
    
% Wprowadźmy także pojęcie \textit{wielomianu minimalnego} oraz udowodnijmy jego istnienie, co będzie przydatne dla udowodnienia twierdzenia \ref{kluczowe}.

\begin{definition}
	Jeśli $G$ jest rozszerzeniem ciała $F$, to \textbf{\textit{wielomianem minimalnym}} dla $g \in G$ nazywamy nierozkładalny moniczny wielomian $m(X) \in F[X]$ taki, że $m(g) = 0$.
\end{definition}
	
\begin{theorem}\label{istnieje_mini}
	Niech $G$ będzie rozszerzeniem ciała $F$ i dla $g \in G$, istnieje niezerowy $f(X) \in F[X]$ taki, że $ f(g) = 0$. Wówczas istnieje niezerowy wielomian minimalny dla $g$ w $F[X]$.
\end{theorem}
	
% Trochę byle jak ten dowód ale jest łatwy i już mi się nie chce.
\begin{proof}
	Niech $I = \{f(X) \, | \, f(X) \in F[X], f(g) = 0\}$. Zauważmy, że $I$ jest ideałem nad $F[X]$. Ponieważ $F$ jest ciałem, to na mocy Lematu \ref{idealy_glowne0} $I$ jest ideałem głównym. Istnieje wiec $m(X) \in F[X]$ takie, że $I = \langle m(X) \rangle$ oraz $m(X)$ ma minimalny stopień w $I$. Dodatkowo ponieważ z założenia $I \neq \{0\}$, istnieje niezerowy wielomian $f(X)$ mający pierwiastek w $g$. Stąd także $m(X)$ nie jest wielomianem zerowym. Jeśli $m(X)$ jest moniczny, to jest wielomianem minimalnym, w przeciwnym przypadku współczynnik przy najwyższej potędze $X$ nie jest jedynką. Ponieważ każdy element niezerowy ma odwrotność w $F$, to istnieje też moniczny wielomian będący wielomianem minimalnym.
	% http://mathonline.wikidot.com/the-minimal-polynomial-of-an-algebraic-element-in-a-field-ex
\end{proof}
	
\begin{lemma} \label{mini_dzieli}
	Niech $G$ będzie rozszerzeniem ciała $F$ oraz $m(X) \in F[X]$ będzie wielomianem minimalnym dla $g \in G$. Wówczas dla każdego  $f(X) \in F[X]$ zachodzi implikacja $f(g) = 0 \Rightarrow m(X) \, | \, f(X)$.
\end{lemma}
	
\begin{proof}
	Własność ta wynika z poprzedniego dowodu. Jeśli $m(X)$ jest wielomianem minimalnym dla $g$ nad $F$ i $f(X) \in F[X]$ oraz $f(g) = 0$, to $f(X)$ należy do ideału głównego generowanego przez $m(X)$. Istnieje zatem $h(X) \in F[X]$ takie, że $f(X) = h(X)m(X)$.
	% http://mathonline.wikidot.com/the-minimal-polynomial-of-an-algebraic-element-in-a-field-ex
\end{proof}
	
\begin{theorem} \label{kluczowe}
	Dla $n, \, q \in \mathbb{N}$ takich, że $NWD(n, q) = 1$, wielomian cyklotomiczny $Q_n(X)$ nad $\mathbb{Z}_q$ jest rozkładalny na nierozkładalne czynniki stopnia $o_n(q)$ w $\mathbb{Z}_q[X]$.
\end{theorem}
	
\begin{proof}
	Niech $\zeta$ będzie pierwotnym pierwiastkiem $n$-tego stopnia nad $\mathbb{Z}_q$. Wprowadźmy oznaczenie $\mathbb{F}_{q^k}$ na zbiór będący ciałem rzędu $q^k$. Zauważmy, że takie ciało istnieje, ponieważ zbiór wielomianów o współczynnikach ze zbioru $\mathbb{Z}_q$ stopnia mniejszego niż $k$ jest ciałem rzędu $q^k$.
				    
	Dowód przebiegał będzie w trzech krokach. 
	\begin{enumerate}[label=\arabic*.,leftmargin=.4in]
		\item Pokażemy, że dla dowolnego $k > 1$ zachodzi $\zeta^{q^k}=\zeta$ wtw, gdy $\zeta \in \mathbb{F}_{q^k}$.
        \item Niech $d$ będzie najmniejszą liczbą taką, że $\zeta \in \mathbb{F}_{q^d}$ oraz $f(X) \in \mathbb{Z}_q[X]$ będzie wielomianem o pierwiastku w $\zeta$ takim, że $deg(f) > 0$. Wówczas istnieje w $\mathbb{Z}_q[X]$ wielomian $h(X)$ taki, że $h(X) \, | \, f(X)$ i $deg(h) = d$.
        \item Wywnioskujemy tezę.
	\end{enumerate}
	\begin{enumerate}[label=Ad.\arabic*.,leftmargin=.4in]
		\item Zauważmy, że jeśli dowolne $a \in \mathbb{F}_{q^k}$, to z twierdzenia Lagrange'a mamy $a^{q^k-1} = 1$, stąd $a^{q^k} = a$. Zauważmy, że równanie $a^{q^k} = a$ ma nie więcej niż $q^k$ pierwiastków, a skoro wszystkie elementy $\mathbb{F}_{q^k}$ są jego pierwiastkami, to wszystkie pierwiastki są elementami $\mathbb{F}_{q^k}$.
        \item Niech $m(X) \in \mathbb{Z}_q[X]$ będzie minimalnym wielomianem dla $\zeta$. Wiemy, że taki istnieje z Twierdzenia \ref{istnieje_mini} oraz ponieważ istnieje niezerowe $Q_n(X) \in \mathbb{Z}_q[X]$. Założyliśmy, że $\zeta \in \mathbb{F}_{q^d}$. Wiemy także, że $\zeta \in \mathbb{Z}_q / \langle m(X) \rangle$, tzn. $\zeta \in \mathbb{F}_{q^{deg(m)}}$. Ponieważ $m(X)$ jest wielomianem minimalnym oraz $d$ jest najmniejszą liczbą spełniającą założenie, otrzymujemy $deg(m) = d$. Na mocy Lematu \ref{mini_dzieli} otrzymujemy dodatkowo, że $m(X)$ dzieli dowolny wielomian $f(X) \in \mathbb{Z}_q[X]$, mający pierwiastek w $\zeta$.
        \item Wiemy, że zachodzi $\zeta^{q^{o_n(q)}}=\zeta$, więc także $\zeta \in \mathbb{F}_{q^{o_n(q)}}$. Ponieważ $\zeta$ jest pierwiastkiem pierwotnym wiemy, że jest to najmniejsza liczba, spełniająca tę własność. Możemy więc skorzystać z faktu udowodnionego w drugim kroku i wywnioskować, że każdy wielomian o pierwiastku w $\zeta$ można podzielić przez pewien inny wielomian należący do $\mathbb{Z}_q[X]$ stopnia $o_n(q)$. Stosując to rozumowanie indukcyjnie możemy wywnioskować tezę.
	\end{enumerate}
	% Ponieważ dla każdego wielomianu, mającego pierwiastek w pierwotnym pierwiastku $n$-tego stopnia z jedności istnieje dzielący go wielomian $h(X)$ stopnia $ $. $m(X)$ dzieli dowolny wielomian, którego pierwiastkiem jest $\zeta$ oraz wszystkie pierwiastki $Q_n(X)$ są pierwiastkami pierwotnymi z jedynki $n$-tego stopnia, możemy wywnioskować, że $Q_n(X)$ można rozłożyć na nierozkładalne wielomiany stopnia $o_n(q)$ w $\mathbb{Z}_q$.
\end{proof}
	
\chapter{Algorytm}

\section{Idea algorytmu}

Algorytm AKS opiera się na uogólnieniu Małego Twierdzenia Fermata dla wielomianów, czyli twierdzeniu, że pierwszość liczby $n, \, n > 2$ jest równoważna z zachodzeniem równości $(X + a)^n = X^n + a \: (mod \: n)$, gdzie $NWD(a, n) = 1$. Jest to własność przydatna bardziej niż podstawowe Małe Twierdzenie Fermata, ponieważ występuje w nim równoważność a nie jednostronna implikacja, która była niewystarczająca, aby zapewnić determinizm w teście pierwszości Fermata. Naiwne sprawdzenie tego twierdzenia skutkowałoby jednak złożonością obliczeniową $O(nlog^2n)$, ponieważ wymagałaby mnożenia wielomianów $n$-tego stopnia. W kontekście problemu PRIMES jest to złożoność niesatysfakcjonująca, ponieważ względem rozmiaru problemu, czyli długości $n$, jest to złożoność wykładnicza. Problem ten rozwiązany został w algorytmie AKS poprzez sprawdzenie równości uogólnionego Małego Twierdzenia Fermata nie w pierścieniu $\mathbb{Z}_n[X]$ a w zawartym w nim pierścieniu ilorazowym zdefiniowanym tak, że długość wielomianów, na których wykonane jest mnożenie, jest wielomianowa względem długości liczby $n$. Poprawność tego podejścia wynika z nietrywialnego twierdzenia, że w odpowiednio wybranym pierścieniu ilorazowym pierścienia $\mathbb{Z}_n[X]$ jeśli równanie $(X + a)^n = X^n + a$ zachodzi dla odpowieniej liczby różnych $a$, to $n$ nie może być liczbą złożoną. 

\section{Schemat algorytmu}
	
\begin{breakablealgorithm}
	\caption{Algorytm AKS}
	\begin{algorithmic}[1]
																											    
		\Require{liczba całkowita $n > 1$}
		\Ensure{\textbf{PIERWSZA} - jeśli $n$ jest pierwsza; \textbf{ZŁOŻONA} - jeśli $n$ jest złożona}
		\If{istnieje takie $a \in \mathbb{N}, b > 1$, że $a^b = n$} \Comment{Krok 1.}
		\State{\Return ZŁOŻONA} 
		\EndIf
		\State{$r \gets$ najmniejsza liczba taka, że zachodzi $o_r(n) > log^2n$} \Comment{Krok 2.}
		\If{istnieje $a \leq r$ takie, że $1 < NWD(a, n) < n$} \Comment{Krok 3.}
		\State{\Return ZŁOŻONA}
		\EndIf
		\If{$n \leq r$} \Comment{Krok 4.} \State{\Return PIERWSZA} \EndIf
		\For{$a\gets1$ \textbf{to} $\lfloor \sqrt{\phi(r)}\, log \, n \rfloor$} \Comment{Krok 5.}
		\If{$(X + a)^n \neq X^n + a \, (mod \, X^r - 1, \, n)$} \Comment{Krok 6.}
		\State{\Return ZŁOŻONA}
		\EndIf
		\EndFor
		\State {\Return PIERWSZA} \Comment{Krok 7.}
	\end{algorithmic}
\end{breakablealgorithm}
	
\section{Dowód poprawności}
    
Dowód poprawności algorytmu przeprowadzimy poprzez udowodnienie serii lematów i ostatecznie wykorzystanie ich do udowodnienia twierdzenia, że algorytm zwróci \textit{PIERWSZA} wtedy i tylko wtedy, gdy liczba $n$ na wejściu jest pierwsza. Lematy prowadzące do końcowego twierdzenia będą często udowodnione z użyciem twierdzeń i lematów z poprzedniego rozdziału. Kluczowym fragmentem dowodu będzie znalezienie sprzeczności w twierdzeniu, że jeśli $n$ jest złożona, to algorytm może zwócić \textit{PIERWSZA} w kroku 7. Zdefiniujemy bowiem na podstawie $n$, jej pierwszego dzielnika $p$ oraz wybranego w trakcie wykonania algorytmu $r$ zbiór, który, korzystając z założeń wynikających z przebiegu algorytmu, będziemy mogli ograniczyć z dwóch stron, doprowadzając do sprzeczności. 

Równoważność między pierwszością liczby $n$ oraz zwróceniem \textit{PIERWSZA} przez algorytm pokażemy poprzez udowodnienie implikacji w dwie strony. Zacznijmy od pokazania, że jeśli $n$ jest liczbą pierwszą, to algorytm zwróci \textit{PIERWSZA}. Aby udowodnić to twierdzenie wykorzystamy dwa lematy, z których będziemy w stanie wywnioskować, że algorytm nie zakończy się zwróceniem \textit{ZŁOŻONA} w 5. kroku.
% Następujące lematy przyjmują bowiem założenia, jakie $n, \, p$ i $r$ spełniają w ostatnim kroku algorytmu.
\begin{lemma}\label{L1}
	Niech $a, \, n \in \mathbb{N}, \, n \geq 2$ i $NWD(a, n) = 1$. Wtedy $n$ jest pierwsza wtw, gdy $(X + a)^n = X^n + a \: (mod \: n)$.
\end{lemma}
	
\begin{proof}
	Rozpatrując współczynniki przy $X^i$ w wielomianie 
	\begin{align*}
		p(X) = (X + a)^n - (X^n + a) 
	\end{align*}
	pokażemy, że $p(X) = 0 \: (mod \, n)$ wtw, gdy $n$ jest pierwsza. 
	\begin{enumerate}[label=\arabic*.,leftmargin=.4in]
		\item Załóżmy, że $n$ jest pierwsza. Wtedy współczynnik przy $X^i$ ($1 \leq i < n$) w wielomianie $p(X)$ jest równy ${n \choose i}a^{n-i} = \frac{n!}{i!(n-i)!} \cdot a^{n-i}$. Z ${n \choose i} \in \mathbb{Z}$ oraz pierwszości $n$ wiemy, że nie istnieje $q$ takie, że $q \, | \, i! \cdot (n-i)! \wedge q \nmid \, (n - 1)!$, więc $\frac{(n - 1)!}{i! \cdot (n - i)!} \in \mathbb{Z}$ oraz $n \, | \, {n \choose i}$. Stąd $n \, | \, p(X)$.
		\item Załóżmy, że $n$ jest złożona. Niech $q$ będzie pewnym dzielnikiem pierwszym $n$ oraz $q^k \parallel n$. Współczynnik przy $X^q$ jest równy ${n \choose q}a^{n-q}$. Możemy zauważyć, że $q^k$ nie dzieli ${n \choose q}$, ponieważ ${n \choose q} = \frac{n!}{q!(n-q)!} = \frac{n \cdot (n-1) \cdot \, \dots \, \cdot (n - q + 1)}{q!}$. Wiemy, że skoro $q$ jest pierwsze i $q \,| \, n$, to 
		      \begin{align*}
		      	q & \nmid (n-1) \cdot \, \dots \, \cdot (n - q + 1), 
		      \end{align*}
		      skąd możemy wywnioskować, że
		      \begin{align*}
		      	q^k & \parallel n \cdot (n-1) \cdot \, \dots \, \cdot (n - q + 1). 
		      \end{align*}
		      Mamy więc $q^k \nmid {n \choose q}$. Ponieważ $a$ jest względnie pierwsze z $n$, to $q \nmid a^{n-q}$, więc $q^k \nmid {n \choose q}a^{n-q}$. Stąd mamy $p(X) \neq 0 \: (mod \, n)$.
	\end{enumerate}
\end{proof}

\begin{lemma} \label{L2}
	Niech $a,\, n, \, r \in \mathbb{N},\, n \geq 2,\, r \geq 1$ i $NWD(a, n) = 1$. Wówczas jeśli $n$ jest pierwsza, to $(X + a)^n = X^n + a \: (mod \: X^r - 1,\, n)$.
\end{lemma}
	
\begin{proof}
	Dowód wynika bezpośrednio z Lematu \ref{L1}. Wiemy, że 
	\begin{align*}
		(X + a)^n - (X^n + a) = 0 \: (mod \, n), 
	\end{align*}
	więc także 
	\begin{align*}
		(X + a)^n - (X^n + a) = 0 \: (mod \: X^r - 1,\, n). 
	\end{align*}
\end{proof}

\begin{theorem}
	Niech $n \in \mathbb{N}, \, n \geq 2$ będzie liczbą podaną na wejściu algorytmu. Jeśli $n$ jest liczbą pierwszą algorytm zwróci \textit{PIERWSZA}.
\end{theorem}
	
\begin{proof}
	Ponieważ $n$ jest liczbą pierwszą, algorytm nie zwróci \textit{ZŁOŻONA} w kroku 1. i 3. Z Lematu \ref{L2} wiemy, że dla każdego $1 \leq a < n$ zachodzi 
	\begin{align*}
		(X + a)^n = X^n + a \: (mod \: X^r - 1, \: n), 
	\end{align*}
	więc algorytm się nie zakończy w kroku 5. Ostatecznie algorytm zwróci \textit{PIERWSZA} w kroku 4 lub 7.
\end{proof}

% Dla udowodnienia implikacji w drugą stronę 
Zacznijmy dowód odwrotnej implikacji od wprowadzenia pojęcia introspektywności oraz udowodnienia związanych z nim własności. 
% W późniejszej części dowodu skorzystamy z introspektywności w kontekście elementów konkretnego zbioru, które pozwolą nam 

\begin{definition}
	Dla ustalonych $r, \, p \in \mathbb{N}$, gdzie $p$ jest pierwsza, liczbę $m \in \mathbb{N}$ nazywamy \textbf{\textit{introspektywną}} modulo $X^r - 1, \, p$ dla wielomianu $f(X)$, jeśli zachodzi \[(f(X))^m = f(X^m) \; (mod \, X^r - 1, \, p).\] 
	% \cite{aks}
\end{definition}
	
%SPRAWDZONE
\begin{lemma}\label{intro1}
	Niech $r, \, p \in \mathbb{N}$ oraz $p$ jest pierwsza. Jeśli $m$ i $m'$ są introspektywne modulo $X^r - 1, \, p$ dla $f(X)$, to $mm'$ także jest introspektywna modulo $X^r - 1, \, p$ dla $f(X)$.
\end{lemma}
	
\begin{proof}
	Z introspektywności $m$ mamy $(f(X))^{mm'} = (f(X^m))^{m'} \, (mod \, X^r - 1, \, p).$ Z introspektywności $m'$ wiemy, że istnieje $g(X) \in \mathbb{Z}_p[X]$ takie, że 
	\begin{align*}
		f(X^{m'}) - {f(X)}^{m'}    & = g(X) \cdot (X^r - 1)     \; (mod \, p)   \\
		f(X^{mm'}) - {f(X^m)}^{m'} & = g(X^m) \cdot (X^{mr} - 1) \; (mod \, p). 
	\end{align*}
	Mamy więc 
	\begin{align*}
		(f(X^m))^{m'} = f(X^{mm'}) \; (mod \, (X^m)^r - 1, \, p), 
	\end{align*}
	a, ponieważ $X^r - 1$ dzieli $X^{mr} - 1$, także 
	\begin{align*}
		(f(X^m))^{m'} = f(X^{mm'}) \; (mod \, X^r - 1, \, p). 
	\end{align*}
	Otrzymujemy więc 
	\begin{align*}
		(f(X))^{mm'} = f(X^{mm'}) \; (mod \, X^r - 1, \, p). 
	\end{align*}
\end{proof}
	
\begin{lemma}\label{intro2}
	Niech $r, \, p \in \mathbb{N}$ oraz $p$ jest pierwsza. Jeśli $m$ jest introspektywna modulo $X^r - 1, \, p$ dla $f(X)$ i $g(X)$, to jest także introspektywna modulo $X^r - 1, \, p$ dla ${f(X) \cdot g(X)}$.
\end{lemma}
	
\begin{proof}
	Mamy \[(f(X))^m = f(X^m) \, (mod \, X^r - 1, \, p)\] oraz \[(g(X))^m = g(X^m) \, (mod \, X^r - 1, \, p).\] Mnożąc stronami otrzymujemy 
	\begin{align*}
		(f(X) \cdot g(X))^m = f(X^m) \cdot g(X^m) \; (mod \, X^r - 1, \, p). 
	\end{align*}
\end{proof}

\begin{lemma}\label{p_intro}
	Jeśli $p$ jest liczbą pierwszą, to dla dowolnych $f(X), g(X) \in \mathbb{Z}_p[X]$ zachodzi w $\mathbb{Z}_p[X]$ \[(f(X) + g(X))^p = (f(X))^p + (g(X))^p.\]
\end{lemma}
	
\begin{proof}
	Mamy \[(f(X) + g(X))^p = (f(X))^p + (g(X))^p + \sum_{i=1}^{i < p}{p \choose i}(f(X))^i\cdot(g(X))^{p - i}.\] Na mocy argumentu użytego w dowodzie Lematu \ref{L1} otrzymujemy wniosek, że dla $1 \leq i < p$ zachodzi $p \, | \, {p \choose i}$, skąd wynika teza.
\end{proof}

\begin{remark*}\label{def}
	Na potrzeby kolejnych lematów ustalmy $n, \, r, \, p \in \mathbb{N}, \, n \geq 2 
	%, \, r < \lceil log^5 \, n \rceil
	$ oraz \[\ell = \lfloor\sqrt{\phi (r)} \, log \, n \rfloor\] takie, że $p$ jest pierwszym dzielnikiem $n$, $o_r(n) > log^2n$, $NWD(r, \, n) = 1$, więc i $NWD(r, \, p) = 1$. Ponadto niech dla każdego $0 \leq a \leq \ell$ zachodzi \[(X + a)^n = X^n + a \: (mod \, X^r - 1, \, n).\] Możemy teraz zdefiniować 
	\begin{align*}
		I = \{(\frac{n}{p})^i \, \cdot \, p^j \, | \, i, \, j \geq 0\},            \\
		P = \{\prod_{a=0}^{\ell} \, (X + a)^{e_a} \, | \, e_a \geq 0\}. 
	\end{align*}
	Niech $G$ będzie zbiorem reszt z dzielenia elementów $I$ przez $r$ oraz niech $t = | \, G \, |$. Niech $Q_r(X)$ będzie $r$-tym wielomianem cyklotomicznym nad $\mathbb{Z}_p$ ($ r \nmid p = char(\mathbb{Z}_p)$). Weźmy nierozkładalny w $\mathbb{Z}_p[X]$ wielomian $h(X) \in \mathbb{Z}_p[X]$ taki, że $h(X) \, | Q_r(X)$ i $deg(h) = o_r(p)$. Z Twierdzenia \ref{kluczowe} wiemy, że taki wielomian istnieje. Zdefiniujmy następnie $F = \mathbb{Z}_p / \langle h(X) \rangle$ oraz $\mathcal{G}$ będący zbiorem elementów $P$ w $F$.
\end{remark*}

Zauważmy, że ustalone powyżej liczby $n, \, r$ spełniają założenia, jakie spełniają odpowiednio zmienne $n$ i $r$ w 7. kroku algorytmu. Jeśli dodatkowo założymy, że $n$ jest złożona, to istnieje $p$ spełniające wszystkie założenia.

Na podstawie zdefiniowanej wcześniej introspektywności oraz jej własności możemy udowodnić następujące twierdzenie.

\begin{lemma}\label{intro}
	Dowolny element $i \in I$ jest introspektywny modulo $X^r - 1, \, p$ dla dowolnego wielomianu $p(X) \in P$.
\end{lemma}
	
\begin{proof}
	Pokażemy, że 
	\begin{enumerate}[label=\arabic*.,leftmargin=.4in] 
		\item dla dowolnego $0 \leq a \leq \ell$ liczby $\frac{n}{p}$ i $p$ są introspektywne dla $X + a$, a następnie 
		\item wywnioskujemy tezę.
	\end{enumerate}
	\begin{enumerate}[label=Ad.\arabic*.,leftmargin=.4in]
		\item Niech $0 \leq a \leq \ell$. Liczba $p$ jest pierwsza, więc z Lematu \ref{L1} otrzymujemy \[(X + a)^p = X^p + a \, (mod \, X^r - 1, \, p),\] więc $p$ jest introspektywne dla $(X + a)$. Z założenia w Uwadze \ref{def} mamy też  \[(X + a)^n = X^n + a \: (mod \, X^r - 1, \, n).\] Weźmy $f_1(X) = (X + a)^{\frac{n}{p}}, \, f_2(X) = X^{\frac{n}{p}} + a \in \mathbb{Z}_p[X]$. Zauważmy, że 
		      \begin{align*}
		      	(f_1(X))^p = X^n + a    & = (f_2(X))^p \; (mod \, X^r - 1, \, p) \\
		      	(f_1(X))^p - (f_2(X))^p & = 0 \; (mod \, X^r - 1, \, p).         
		      \end{align*}
		      Z Lematu \ref{p_intro} mamy
		      \begin{align*}
		      	(f_1(X) - f_2(X))^p & = 0 \; (mod \, X^r - 1, \, p)       \\
		      	f_1(X)              & = f_2(X) \; (mod \, X^r - 1, \, p). 
		      \end{align*}
		      Więc $\frac{n}{p}$ także jest introspektywne modulo $X^r - 1, \, p$ dla $X + a$.
		\item Ponieważ elementy zbioru $I$ są iloczynami liczb $\frac{n}{p}$ i $p$, a elementy zbioru $P$ są iloczynami wielomianów $X + a, \, 0 \leq a \leq \ell$, z Lematów \ref{intro1} i \ref{intro2} możemy wywnioskować tezę.
	\end{enumerate}
\end{proof} 

Żeby ograniczyć z dołu rozmiar zbioru $\mathcal{G}$ wprowadzimy i udowodnimy dwa pomocnicze lematy. Udowodnimy, że $X$ jest pierwotnym pierwiastkiem $r$-tego stopnia z jedności w $F$, dzięki czemu będziemy ostatecznie w stanie stwierdzić, że w $\mathcal{G}$ jest co najmniej tyle elementów, ile różnych wielomianów stopnia mniejszego niż $t$ w $P$. Drugi lemat pozwoli nam natomiast oszacować dokładniej ich liczbę.

% A nie w Z_p?
\begin{lemma}\label{X_pierw}
	$X$ jest pierwotnym pierwiastkiem $r$-tego stopnia z jedności w $F$.
\end{lemma}
	
\begin{proof}
	% Z twierdzenia \ref{kluczowe} wiemy, że pierwiastki $h(Y)$ w $F$ są pierwotnymi pierwiastkami $r$-tego stopnia z jedności w $\mathbb{Z}_p$, więc też w $F$. Zauważmy, że $h(X) = 0$ w $F$, więc $X$ jest pierwiastkiem $h(Y)$ nad $F$
	Z Lematu \ref{cyklo_dzieli} oraz ponieważ $h(X) \, | \, Q_r(X)$, mamy $h(X) \, | \, X^r - 1$, więc $X^r = 1$ w $F$, czyli $X$ jest pierwiastkiem $r$-tego stopnia z jedności w $F$. 
	Załóżmy nie wprost, że $X$ nie jest pierwotnym pierwiastkiem. Oznacza to, że istnieje $k < r$ takie, że $X^k = 1$ w $F$. Implikuje to, że $h(X) \, | \, X^k - 1$ w $\mathbb{Z}_p[X]$. 
	Rozważmy pierwiastki $h(X)$ i $X^k - 1$ w $r$-tym ciele cyklotomicznym nad $\mathbb{Z}_p$. Istnieje w nim pierwiastek pierwotny $r$-tego stopnia $\zeta$, który jest pierwiastkiem $h(X)$. 
	% UWAGA TO MOŻE BYĆ NIEPRAWDA
	Mamy więc $h(\zeta) = 0 \; (mod \, p)$ w $\mathbb{Z}_p^{(r)}$, a ponieważ istnieje pewne $p(X) \in \mathbb{Z}_p[X]$ takie, że $(X^k - 1) = p(X) \cdot h(X) \; (mod \, p)$, to także $\zeta^k - 1 = 0 \; (mod \, p)$ w $\mathbb{Z}_p^{(r)}$. Wynika stąd, że $\zeta$ jest też pierwiastkiem z jedności $k$-tego stopnia w $\mathbb{Z}_p$, a ponieważ $k < r$, mamy sprzeczność z założeniem o pierwotności $\zeta$.
	% Ponieważ $h(X) \, | \, X^k - 1$ także w rozszerzeniu ciała $\mathbb{Z}_p$, to $\zeta^k - 1 = 0$ w $\mathbb{Z}_p^{(r)}$. Otrzymaliśmy sprzeczność z założeniem, że $\zeta$ jest pierwiastkiem pierwotnym, ponieważ $k < r$.
	%Pokażemy, że (1) w $F$ jest nie więcej niż $o_r(p)$ pierwiastków $r$-tego stopnia z jedności oraz, że (2) $X$ generuje dokładnie $o_r(p)$ różnych pierwiastków $r$-tego stopnia z jedności. \newline
	%(1) Niech $\zeta \in F$ będzie pierwotnym pierwiastkiem $r$-tego stopnia z jedności w $F$. Wiemy, że $\zeta$ generuje grupę wszystkich pierw
	% TODO uwaga
	% Wiemy także, że $deg(h) = o_r(p)$, więc nie więcej niż $o_r(p)$ pierwiastków $r$-tego stopnia z jedności należy do $F$. Spójrzmy na ciąg $1, X, \, \dots, X^{o_r(p) - 1}$. Zauważmy, że wszystkie jego elementy są różne w $F$ oraz wszystkie są pierwiastkami $r$-tego stopnia z jedności w $F$. 
	% TODO: prymitywnym
\end{proof}

% \begin{lemma}
% 	$\mathcal{G}$ jest grupą z mnożeniem, generowaną przez zbiór $\mathcal{G}_{gen} = \{X, \, X + 1, \, \dots, X + \ell\}$ w ciele $F$.
% \end{lemma}
	
% \begin{observation}
% 	$\mathcal{G} \subset F$.
% \end{observation}
	
% %OK
% \begin{proof}
% 	(1) $\mathcal{G}$ jest grupą. Łatwo można zauważyć, że $\mathcal{G}$ zawiera element neutralny i jest zamknięty na mnożenie. Wystarczy więc pokazać, że dla każdego $g \in \mathcal{G}$ istnieje element odwrotny. Wykorzystamy argument z dowodu lematu \ref{el_odwr}, tzn. ponieważ $\mathcal{G}$ jest skończonego rozmiaru, dla dowolnego $g \in \mathcal{G}$ także $g^2, \, \dots, g^{| \,  \mathcal{G}\, | + 1}\in \mathcal{G}$. Istnieje $g^i \in \mathcal{G}, \,0 \leq i$, będące odwrotnością $g$.\newline
% 	(2) Zbiór $\mathcal{G}_{gen}$ generuje $\mathcal{G}$. Dla $g \in \mathcal{G}, \, g \neq 1$ oczywistym jest, że $g$ można przedstawić jako iloczyn elementów $\mathcal{G}_{gen}$. Wiemy, że $h(X)$ dzieli $Q_r(X)$, czyli też, na mocy lematu \ref{cyklo_dzieli}, $X^r - 1$. Mamy więc $X^r = 1$ w $\mathcal{G}$, czyli $1$ także jest generowana przez $\mathcal{G}_{gen}$. Odwrotny wniosek, że każdy element generowany przez $\mathcal{G}_{gen}$ należy do $\mathcal{G}$ jest oczywisty.
% \end{proof}

\begin{lemma}\label{liczba_wielo}
	Dla $k + 1$ wielomianów pierwszego stopnia o różnych pierwiastkach $f_1(X), \, \dots,$ $\,f_{k + 1}(X)$ istnieje co najmniej ${k + d \choose k + 1}$ różnych wielomianów $f(X)$ stopnia mniejszego niż $d$, które można przedstawić jako $f(X) = \prod_{i=1}^{k+1}(f_i(X))^e$, gdzie $e \in \mathbb{N}$.
\end{lemma}
	
\begin{proof}
	Przedstawimy, w jaki sposób mozna skonstruować bijekcję między sposobem wyboru $k + 1$ z $k + d$ elementów ciągu a różnymi wielomianami $f(X)$. Spójrzmy na ciąg $k + d$ elementów z $k + 1$ elementami wyróżnionymi. Jeśli spojrzymy na liczbę elementów między elementami wyróżnionymi otrzymamy ciąg $a_1, \, \dots, a_{k + 2}$ taki, że $\sum_{i = 1}^{k + 2}a_i = d - 1$.  Powiemy, że takiemu ciągowi odpowiada wielomian $f(X) \in G$, jeśli $f(X) = \prod_{i = 1}^{k + 1} (f_i(X))^{a_i}$. Łatwo zauważyć, że jednemu takiemu wyróżnieniu elementów ciągu odpowiada dokładnie jeden wielomian oraz dla różnych wyróżnień elementów, odpowiadające wielomiany są różne. Stąd otrzymujemy tezę, że różnych wielomianów stopnia mniejszego niż $d$ w $F$ jest co najmniej ${k + d \choose k + 1}$.
\end{proof}

Mając już pomocnicze lematy, możemy przejść do znalezienia ograniczenia dolnego rozmiaru zbioru $\mathcal{G}$.
	
\begin{lemma} \label{lower}
	$| \, \mathcal{G} \,| \geq {t + \ell \choose t - 1}$.
\end{lemma}
	
\begin{proof}
	Pokażemy, że 
	\begin{enumerate}[label=\arabic*.,leftmargin=.4in] 
		\item dowolne dwa różne wielomiany stopnia mniejszego niż $t$ w $P$ są różne także w $\mathcal{G}$ oraz
		\item w $P$ jest co najmniej  ${t + \ell \choose t - 1}$ różnych wielomianów stopnia mniejszego niż $t$. 
	\end{enumerate}
	\begin{enumerate}[label=Ad.\arabic*.,leftmargin=.4in]
		\item Niech $f(X) \neq g(X) \in P, \, deg(f), deg(g) < t$. Załóżmy nie wprost, że $f(X) = g(X)$ w $F$. 
		      Niech $Q(Y) = f(Y) - g(Y)$, gdzie $Y$ jest elementem $F$, czyli także wielomianem. Zauważmy, że oczywistym pierwiastkiem $Q(Y)$ jest $X$. Wiemy, że $f(X) \neq g(X)$, więc $Q(Y)$ nie jest wielomianem zerowym. Weźmy dowolne $i \in I$. Z Lematu \ref{intro} wiemy, że $i$ jest introspektywne modulo $X^r - 1, \, p$ dla dowolnego wielomianu z $P$, więc też dla dowolnego wielomianu w $\mathcal{G}$. Mamy więc w $F$
		      \begin{align*}
		      	(f(X))^i = (g(X))^i \; \text{i} \; f(X^i) = g(X^i). 
		      \end{align*}
		      Oznacza to, że dla każdego $i \in I$ $X^i$ jest pierwiastkiem $Q(Y)$ w $F$, czyli też dla każdego $i' \in G$ $X^{i'}$ jest pierwiastkiem $Q(Y)$ w $F$. Załóżmy nie wprost, że istnieją $i < i' \in G$ takie, że $X^i = X^{i'}$ w $F$. Mamy więc $h(X) \, | \, X^i$ w $\mathbb{Z}_p[X]$ lub $X^{i - i'} = 1$. Pierwszy argument tej dysjunkcji jest w oczywisty sposób nieprawdziwy, ponieważ $h(X)$ nie ma pierwiastka w zerze, a drugi jest sprzeczny z Lematem \ref{X_pierw}.
		      Znaleźliśmy więc $|\,G\,| = t$ pierwiastków $Q(Y)$ w $F$ więc $Q(Y)$ jest wielomianem zerowym w $F$ lub $deg(Q) \geq t$, zatem doszliśmy do sprzeczności z założeniem.
		\item Z założeń o $\ell$ i $o_r(n)$ mamy $\ell = \lfloor \sqrt{\phi(r)} \, log\, n \rfloor < \sqrt{r} \, log \, n $ oraz $o_r(n) > log^2 \, n$. Ponieważ $r > o_r(n)$, otrzymujemy \[\ell < \sqrt{r} \, log \, n < \sqrt{r \cdot o_r(n)} < r < p.\] W połączeniu z $deg(h) > 1$ mamy wniosek że dla dowolnych $0 \leq i < j \leq \ell$ $X + i \neq X + j$ w $F$ oraz $X + i$ i $X + j$ są niezerowe. 
		      \newline Z Lematu \ref{liczba_wielo} otrzymujemy wniosek, że w $P$, a co za tym idzie także w $\mathcal{G}$, jest co najmniej ${t + \ell \choose \ell + 1} = {t + \ell \choose t - 1}$ różnych wielomianów stopnia mniejszego niż $t$. Stąd $| \, \mathcal{G} \, | \geq {t + \ell \choose t - 1}$.
	\end{enumerate}
\end{proof}
    
Następnym krokiem będzie znalezienie ograniczenia górnego dla rozmiaru zbioru $\mathcal{G}$. Wykorzystamy do tego wiedzę o introspektywności elementów zbioru $I$ dla elementów zbioru $\mathcal{G}$.

\begin{lemma} \label{upper}
	Jeśli $n \neq p^e, \, e \in \mathbb{N}$, to $| \, \mathcal{G} \, | \leq n^{\sqrt{t}}$.
\end{lemma}
	
\begin{proof}
	Weźmy \[I' = \{(\frac{n}{p})^i \cdot p^j \, | \, 0 \leq i, \, j \leq \lfloor \sqrt{t} \rfloor \} \subset I.\] Ponieważ $n$ nie jest potęgą $p$, \[i \neq i' \vee \, j \neq j' \Rightarrow (\frac{n}{p})^i \cdot p^j \neq (\frac{n}{p})^{i'} \cdot p^{j'}.\] Mamy więc $| \, I' \, | = (\lfloor \sqrt{t} \rfloor + 1)^2 > t$. Ponieważ $| \, G \, | = t$, istnieją takie ${i_1 < i_2 \in I'}$, że $i_1 = i_2 \, (mod \, r)$. W połączeniu z $X^r = 1 \, (mod \, X^r - 1)$ otrzymujemy \[X^{i_1} = X^{i_2} \, (mod \, X^r - 1),\] a więc i \[X^{i_1} = X^{i_2} \, (mod \, X^r - 1, \, p).\]  Weźmy dowolny wielomian $f(X) \in P$. Z Lematu \ref{intro} mamy \[(f(X))^{i_1} = f(X^{i_1}) = f(X^{i_2}) = (f(X))^{i_2} \; (mod \,  X^r - 1, \, p).\] Oznacza to, że dowolny $f(X) \in \mathcal{G}$ jest pierwiastkiem wielomianu $Q(Y) = Y^{i_1} - Y^{i_2}$ w $F$. Skoro $\mathcal{G} \subset F$, to $Q(Y)$ ma co najmniej $| \, \mathcal{G} \, |$ różnych pierwiastków w $F$ oraz \[deg(Q) = i_2 \leq (\frac{n}{p} \cdot p)^{\lfloor \sqrt{t} \rfloor} \leq n^{\sqrt{t}}.\] Otrzymujemy więc $| \, \mathcal{G} \, | \leq deg(Q) \leq n^{\sqrt{t}}$.
\end{proof}

Mając już ograniczenia z dwóch stron zbioru $\mathcal{G}$ możemy je ze sobą porównać, czym będziemy chcieli ostatecznie dojść do sprzeczności. W tym celu skorzystamy z dodatkowych dwóch ograniczeń dolnych mocy zbioru $G$, wprowadzonych w kolejnych lematach.

\begin{lemma}\label{odwrotny}
	Jeśli $a, r \in N, \, NWD(a, r) = 1$, to istnieje $a^{-1}$ takie, że $aa^{-1} = 1 \, (mod \, r).$
\end{lemma}
	
\begin{proof}
	Spójrzmy na ciąg $a, a^2, \, \dots, a^{r+1}$. Istnieją w nim $1 \leq i < j \leq r + 1$ takie, że $a^i = a^j \, (mod \, r)$, Ponieważ $NWD(a, r) = 1$, to także $NWD(a^i, r) = NWD(a^j, r) = 1$. Mamy $a^ia^{j-i} = a^i \, (mod \, r),$ a ponieważ $a^i$ jest niezerowe, to $a^{j - i} = 1 \, (mod \, r)$ i ostatecznie $a \cdot a^{j - i - 1} = 1 \, (mod \, r)$, więc znaleźliśmy $a^{-1}$.
\end{proof}

\begin{lemma} \label{phi_r}
	$t = | \, G \, | \geq \phi(r).$
\end{lemma}
	
\begin{proof}
	Weźmy zbiór $A$ różnych $a_i$ takich, że $a_i < r$ oraz $NWD(a_i, r) = 1$ dla ${1 \leq i \leq k}$. Z definicji funkcji Eulera mamy $| \, A \, | = \phi(r)$. Niech \[B = \{b \, | \, b = p \cdot a_i \, (mod \, r), \, b < r, \, a_i \in A\}.\] Zauważmy, że dla wszystkich $b \in B$ zachodzi $NWD(b, r) = 1$, więc $B \subseteq A.$ Pokażemy, że $A = B$. Załóżmy nie wprost $p \cdot a_i = p \cdot a_j \, (mod \, r), 1 \leq i < j \leq \phi(r)$. Z Lematu \ref{odwrotny} wiemy, że istnieje $p^{-1} \in \mathbb{Z}_p$. Więc mnożąc stronami przez $p^{-1}$ otrzymujemy sprzeczność. \newline
	Mamy $A = B$, możemy więc wywnioskować równanie 
	\begin{align*}
		p^{\phi(r)} \cdot a_1 \cdot \dots \cdot a_{\phi(r)} &= a_1 \cdot \dots \cdot a_{\phi(r)} \, (mod \, r) \\
		p^{\phi(r)} & = 1 \, (mod \, r) &   & \text{(Dla każdego $a_i$ istnieje $a_i^{-1}$.)} 
	\end{align*}
	Z twierdzenia Lagrange'a mamy wniosek, że $\phi(r)$ dzieli moc grupy, generowanej przez $p$ modulo $r$, czyli zawartej w $G$, skąd wynika teza.
\end{proof}

\begin{lemma}\label{el_odwr}
	$\langle G, \cdot \rangle$ jest podgrupą $\mathbb{Z}_r^*$ oraz $|\,G\,| > log^2n$.
\end{lemma}
	
\begin{proof}
	Dowód przebiegać będzie w dwóch krokach.
	\begin{enumerate}[label=\arabic*.,leftmargin=.4in]
		\item Udowodnimy, że $\langle G, \cdot \rangle$ spełnia definicję grupy i zawiera się w $\mathbb{Z}_r^*$.
		      \begin{enumerate}[label=1.\arabic*.]
		      	\item Oczywistym jest, że $G \subseteq \mathbb{Z}_r$. Wiemy, że $NWD(n, \, r) = 1$ oraz $p \, | \, n$, więc $NWD(p, \, r) = 1$. Wynika stąd, że nie istnieje w $I$ element podzielny przez $r$, więc $0 \notin G$. Mamy więc $G \subseteq \mathbb{Z}_r^*$. 
		      	\item $(\frac{n}{p})^0\cdot p^0 = 1 \in G$, czyli istnieje element neutralny w $G$. 
		      	\item Mnożenie spełnia własności działania w grupie, co wynika z własności mnożenia.
		      	\item Żeby pokazać zamkniętość na mnożenie, weźmy dowolne \[g_1 = (\frac{n}{p})^{i_1} \, \cdot \, p^{j_1} \, (mod\,r), \, g_2 = (\frac{n}{p})^{i_2} \, \cdot \, p^{j_2}  \, (mod\,r) \in G,\] gdzie $\, i_1, \,i_2, \,j_1, \, j_2 \geq 0$. Wtedy \[g_1g_2 = (\frac{n}{p})^{i_1 + i_2} \, \cdot \, p^{j_1 + j_2} \, (mod\,r)\]. Więc $g_1g_2\in G$.
		      	\item Weźmy dowolne $g \in G$. Wiemy, że istnieją $1 \leq i < j \leq | \, G \, | + 1$ takie, że $g^i = g^j$. Ponieważ $g \neq 0$ mamy $g^{j - i} = 1$, więc mamy $g^{j - i - 1} \in G$, będące odwrotnością $g$.
		      \end{enumerate}
		\item Pokażemy, że $|\,G\,| > log^2n$. Załóżmy nie wprost, że $|\,G\,| \leq log^2n$. Spójrzmy na ciąg $1,\, n, \, \dots\,, n^{|G|}$ modulo $r$. Jest to ciąg $|G| + 1$ liczb, należących do $G$. Wynika stąd, że istnieją $k, l \in \mathbb{N}, 0 \leq k < l \leq |\,G\,|$ takie, że $n^k = n^l \, (mod\,r)$. Mamy więc $n^{l-k} = 1 \, (mod\,r)$. $l - k \leq |\,G\,| \leq log^2n$, co jest sprzeczne z założeniem, że $o_r(n) > log^2n$. 
	\end{enumerate}
\end{proof}

Dodatkowo w rozwijaniu nierówności w ostatecznym ciągu przekształceń skorzystamy z następującego lematu.

\begin{lemma}\label{newton1}
	Dla $n \in \mathbb{N}, \, n \geq 2$ zachodzi ${2n + 1 \choose n} \geq 2^{n+1}$.
\end{lemma}
	
\begin{proof}
	Dowód przebiegał będzie przez indukcję. Przypadek dla $n = 2$ jest trywialny. Mamy ${5 \choose 2} = 10 > 2^3 = 8.$\newline
	Przyjmijmy założenie indukcyjne ${2n + 1 \choose n} > 2^{n+1}$. Pokażemy, że ${2n + 3 \choose n + 1} > 2^{n+2}$. Mamy
	\begin{align*}
		{2n + 3 \choose n + 1} &= {2n + 2 \choose n} + {2n + 2 \choose n + 1} \\
		&= {2n + 2 \choose n} + {2n + 1 \choose n + 1} + {2n + 1 \choose n} \\
		  & = {2n + 2 \choose n} + 2\, {2n + 1 \choose n} &   & \text{(Z założenia ${2n + 1 \choose n} > 2^{n+1}$)} \\
		&> 2^{n+2},
	\end{align*}
	skąd teza.
\end{proof}

Mając już ograniczenie górne i dolne mocy $\mathcal{G}$ oraz dodatkowe pomocnicze nierówności, możemy udowodnić docelową implikację, że jeśli algorytm zróci \textit{PIERWSZA} to $n$ jest liczbą pierwszą.
	
\begin{theorem}\label{T1}
	Niech $n \in \mathbb{N}, \, n \geq 2$ będzie liczbą podaną na wejściu algorytmu. Jeśli algorytm zwróci \textit{PIERWSZA}, to $n$ jest pierwsza.
\end{theorem}
	
\begin{proof}
	Algorytm może zwrócić \textit{PIERWSZA} tylko w kroku 4. i 7.
	\begin{enumerate}[label=\arabic*.,leftmargin=.4in]
		\item Jeśli algorytm zakończył wykonanie w kroku 4., to $r \geq n$, oraz \[\forall_{2 \leq a < r} \, NWD(a, \, n) = n \vee NWD(a, \, n) = 1.\] Oznacza to, że nie istnieje $2 \leq a < n$ będące właściwym dzielnikiem $n$, więc $n$ jest pierwsze.
		\item Załóżmy nie wprost, że algorytm zakończył wykonanie w kroku 7., zwracając \textit{PIERWSZA} i $n$ jest złożona. Ponieważ algorytm nie zakończył się w kroku 1., wiemy, że $n$ nie jest potęgą żadnej liczby naturalnej, w szczególności nie istnieją takie $p < n, k \in \mathbb{N}$, gdzie $p$ jest pierwsze, że $n = p^k$. W kroku 2. zostaje wybrane najmniejsze takie $r$, że $o_r(n) > log^2n$. Ponadto z niespełnionego warunku w kroku 3. wiemy, że dla $1 \leq a \leq r$ zachodzi $NWD(a, \, n) = 1$, w szczególności $NWD(r, \, n) = 1$. Z kroków 4. i 5. mamy $n > r$ oraz ${\forall_{1 \leq a \leq \lfloor \sqrt{\phi(r)} \, log \, n \rfloor} \, (X + a)^n = X^n + a \: (mod \, X^r - 1, \, n).}$ Z założenia, że $n$ jest liczbą złożoną wiemy, że istnieje $p$, będące pierwszym dzielnikiem $n$. Mamy więc $n, r, p \in \mathbb{N}$, spełniające założenia w Uwadze \ref{def}. Weźmy zdefiniowany w niej zbiór $\mathcal{G}$. Na mocy Lematu \ref{lower} mamy nierówność $| \, \mathcal{G} \, | \geq {t + \ell \choose t - 1}$ oraz z Lematu \ref{el_odwr} oraz Uwagi \ref{def} zachodzi ${t > log^2n,}$ ${\ell = \lfloor \sqrt{\phi(r)}log \, n \rfloor.}$ Możemy więc wywnioskować nierówność
		      \begin{align*}
		      	| \, \mathcal{G} \, | &\geq {t + \ell \choose t - 1} \\
		      	  & \geq {\lfloor \sqrt{t}\, log \, n \rfloor + 1 + \ell \choose \ell + 1}                      &   & \text{Z ${t > log^2n}$ mamy ${t \geq \lfloor \sqrt{t}\, log \, n} \rfloor + 1$.}                                                               \\
		      	& = {\lfloor \sqrt{t}\, log \, n \rfloor + 1 + \ell \choose \lfloor \sqrt{t}\, log \, n \rfloor} \\
		      	  & \geq {2\lfloor \sqrt{t}\, log \, n \rfloor + 1 \choose \lfloor \sqrt{t}\, log \, n \rfloor} &   & \text{Z $\ell = \lfloor \sqrt{\phi(r)}log \, n \rfloor$ oraz Lematu \ref{phi_r} otrzymujemy $\ell \geq \lfloor \sqrt{t} \, log \, n \rfloor$.} \\
		      	  & > 2^{\lfloor \sqrt{t}\, log \, n \rfloor + 1}                                               &   & \text{Z Lematu \ref{newton1}.}                                                                                                                 \\
		      	&\geq 2^{\sqrt{t}\,log \,n} \\
		      	&= n^{\sqrt{t}}.
		      \end{align*}
		      Mamy więc $| \, \mathcal{G} \, | > n ^{\sqrt{t}}$ oraz, ponieważ $n$ nie jest potęgą liczby pierwszej, z lematu \ref{upper} $| \, \mathcal{G} \, | \leq n^{\sqrt{t}}.$ Otrzymaliśmy sprzeczność, więc $n$ nie jest liczbą złożoną.
	\end{enumerate}
\end{proof}
	
\begin{theorem} \label{T2}
	Algorytm zwróci \textit{PIERWSZA} wtw, gdy $n$ jest liczbą pierwszą.
\end{theorem}
	
\begin{proof}
	W Twierdzeniach \ref{T1} i \ref{T2} udowodniliśmy implikacje w dwie strony, skąd wynika teza.
\end{proof}
	
\section{Złożoność obliczeniowa}
    
Oszacowanie złożoności obliczeniowej algorytmu jest o wiele prostsze niż udowodnienie poprawności i wymagać będzie tylko odpowiedniego ograniczenia wartości $r$. Aby to osiągnąć pokażmy najpierw pomocniczy lemat o dolnym ograniczeniu namniejszej wspólnej wielokrotności $n$ kolejnych liczb.

\begin{lemma} \label{3.1}
	Niech $\ell_n = NWW(1, \dots, n)$. Wtedy dla $n \geq 9$ zachodzi $\ell_n \geq 2^n$.
\end{lemma}
	
% Z internetu, ale zmodyfikowane, bo nie umiem całek
%https://math.stackexchange.com/questions/851328/textlcm1-2-3-ldots-n-geq-2n-for-n-geq-7
\begin{proof}
	Pokażemy, że 
	\begin{enumerate}[label=\arabic*.,leftmargin=.4in]
		\item dla dowolnego $m \leq n, \, m \in \mathbb{N}$ zachodzi $m \cdot {n \choose m} \, | \, \ell_n$, a następnie 
		\item wywnioskujemy tezę.
	\end{enumerate}
	\begin{enumerate}[label=Ad.\arabic*.,leftmargin=.4in]
		\item Weźmy dowolne $m \leq n, \, m \in \mathbb{N}$. Niech $q$ będzie dowolną liczbą pierwszą taką, że $q \, | \, \ell_n$. Z własności $\ell_n$ i monotoniczności funkcji $log_q\, x$ możemy wywnioskować, że $q^{\lfloor log_q n \rfloor} \parallel \ell_n$. Niech $q^l \parallel m$. Zauważmy, że \[q^{\sum_{i=1}^{i \leq \lfloor log_q n \rfloor} \lfloor \frac{n}{q^i}\rfloor} \parallel n!.\] Analogicznie $q^{\sum_{i=1}^{i \leq \lfloor log_q m \rfloor} \lfloor \frac{m}{q^i}\rfloor} \parallel m!$ i $q^{\sum_{i=1}^{i \leq \lfloor log_q (n-m) \rfloor} \lfloor \frac{n-m}{q^i}\rfloor} \parallel (n-m)!$. Ponieważ $m, \, n - m \leq n$ zachodzi $q^{\sum_{i=1}^{i \leq \lfloor log_q n \rfloor} \lfloor \frac{m}{q^i}\rfloor} \parallel m!$ i $q^{\sum_{i=1}^{i \leq \lfloor log_q n \rfloor} \lfloor \frac{n-m}{q^i}\rfloor} \parallel (n-m)!$. 
		      Otrzymujemy \[q^{\sum_{i=1}^{i \leq \lfloor log_q n \rfloor} \lfloor \frac{n}{q^i}\rfloor - (\lfloor \frac{m}{q^i}\rfloor + \lfloor \frac{n-m}{q^i}\rfloor)} \parallel {n \choose m}.\]    
		      Zauważmy, że jeśli $q^i \, | \, m$, to $\lfloor \frac{n}{q^i}\rfloor - (\lfloor \frac{m}{q^i}\rfloor + \lfloor \frac{n-m}{q^i}\rfloor) = 0$, a w przeciwnym wypadku $\lfloor \frac{n}{q^i}\rfloor - (\lfloor \frac{m}{q^i}\rfloor + \lfloor \frac{n-m}{q^i}\rfloor) \leq 1$. Stąd mamy \[\sum_{i=1}^{i \leq \lfloor log_qn \rfloor} \lfloor \frac{n}{q^i}\rfloor - (\lfloor \frac{m}{q^i}\rfloor + \lfloor \frac{n-m}{q^i}\rfloor) \leq \lfloor log_qn \rfloor - l,\] a ponieważ $q^l \parallel m$, otrzymujemy wniosek, że jeśli $q^i \, | \, m \cdot {n \choose m}$, to $i \leq \lfloor log_qn \rfloor$. Ponieważ nierówność ta zachodzi dla każdego pierwszego dzielnika, możemy wywnioskować, że $m \cdot {n \choose m} \, | \, \ell_n$.
		\item W szczególności mamy \[n \cdot {2n \choose n} \, | \, \ell_{2n}\] oraz \[(n+1){2n + 1 \choose n + 1} = (2n + 1){2n \choose n}\, |\, \ell_{2n+1}.\] Wiemy, że $NWD(n,\, 2n + 1) = 1$ oraz $\ell_{2n} \, | \, \ell_{2n + 1}$, więc \[n(2n + 1){2n \choose n}\, |\, \ell_{2n + 1}.\] Możemy stąd przejść do nierówności \[\ell_{2n + 1} \geq n(2n + 1){2n \choose n} \geq n \sum_{i=0}^{i \leq 2n}{2n \choose n} \geq n {\sum_{i=0}^{i \leq 2n}{2n \choose i}} = n(1 + 1)^{2n} = n \, 4^n.\]
		      Mamy więc dla $n \geq 4$ nierówność $\ell_{2n+2} \geq \ell_{2n+1} \geq 2^{2n + 2}$, skąd bezpośrednio możemy wywnioskować $\ell_n \geq 2^n$ dla $n \geq 9$.
	\end{enumerate}		
\end{proof}

% SPRAWDZONE
\begin{lemma}\label{r_szacowanie}
	Niech $n \in \mathbb{N}, \, n \geq 2$, wtedy istnieje takie $r \leq \max \{3, \lceil\log^5n\rceil \}$, $r \in \mathbb{N}$, że $o_r(n) > log^2n$.
\end{lemma}
	
\begin{proof}
	Przypadek, gdy $n=2$ jest trywialny, ponieważ teza zachodzi dla $r=3$. Podobnie dla $n=3$, warunki spełnia $r=4$.\newline
	Załóżmy więc, że $n \geq 4$. Niech $B = \lceil log^5n \rceil$. Wtedy $B > 10$. \newline
	Spójrzmy na najmniejsze takie $r$, że \[ r \, \nmid \, n^{\lfloor log B \rfloor} \: \prod_{i=1}^{i \leq \lfloor log^2 n \rfloor}(n^i - 1).\]
	Niech $P = n^{\lfloor log B \rfloor} \: \prod_{i=1}^{i \leq \lfloor log^2 n \rfloor}(n^i - 1)$. 
	Istnieje więc pewne $q$ takie, że $q \, | \, r$ i $q \nmid P$. $\lfloor log B \rfloor \geq 1$, więc możemy wywnioskować, że $q \nmid n$. Wynika stąd, że $q \nmid NWD(r,\, n)$, więc $\frac{r}{NWD(r, \, n)} \nmid P$. Znaleźliśmy więc liczbę $\frac{r}{NWD(r, \, n)} \leq r$, która nie dzieli $P$. Z założenia, że $r$ jest najmniejsze takie, że $r \nmid P$ mamy $NWD(r, \, n) = 1$.\newline
	Dodatkowo wiemy, że $\forall_{1 \leq i \leq \lfloor log^2 n \rfloor} \, r \nmid (n^i - 1)$, więc nie istnieje takie $1 \leq i \leq \lfloor log^2 n \rfloor$, że $n^i = 1 \, (mod \, r)$. Oznacza to, że $o_r(n) > log^2n$.
	Możemy też ograniczyć $P$ z góry:
	\[n^{\lfloor log B \rfloor} \: \prod_{i=1}^{i \leq \lfloor log^2 n \rfloor}(n^i - 1) < n^{\lfloor log B \rfloor} \: \prod_{i=1}^{i \leq \lfloor log^2 n \rfloor}n^i <  n^{\lfloor log B \rfloor} \: n^{\frac{log^2n(log^2n + 1)}{2}} \leq n^{{\lfloor log B \rfloor} + \frac{log^4n + log^2n}{2}}.\]
	%%%%% UWAGA TUTAJ! RÓŻNI SIĘ OD ORYGINAŁU. NIE ZGADZAM SIĘ Z JEDNYM PRZEJŚCIEM TAM %%%%%
	% TODO - zapytać o to
	Dla $n \geq 4$ mamy\[n^{{\lfloor log B \rfloor} + \frac{log^4n + log^2n}{2}} \leq n^{log^4n} \leq 2^{log^5n} \leq 2^B.\]
	Wiemy, że $B > 10$, więc z Lematu \ref{3.1} mamy $\ell_B \geq 2^B > P$. Oznacza to, że istnieje $l \in \{1, \dots, B\}$ takie, że $l \nmid P$. Z założenia o $r$ mamy, że $r \leq l \leq B$.
\end{proof}

Ograniczenie $r$ pozwala nam już bezpośrednio ograniczyć złożoność obliczeniową algorytmu.

\begin{theorem}
	Złożoność obliczeniową algorytmu można ograniczyć asymptotycznie poprzez $O(log^{\frac{21}{2}}n \cdot log \, log \, n)$.
\end{theorem}
	
\begin{proof}
	Przeanalizujmy kolejne kroki algorytmu pod kątem złożoności obliczeniowej.
	\begin{enumerate}[label=(krok \arabic*.),leftmargin=.4in]
		\item W kroku 1. algorytm sprawdzi dla wszystkich możliwych wartości $b$, których jest nie więcej niż $log\,n$, czy dla pewnego $a$ zachodzi $a^b = n$. Do znalezienia możliwego wykładnika $a$ użyć można wyszukiwania binarnego dla wartości od $2$ do $n$. Sprawdzenie możliwego $a$ wykonane w wyszukiwaniu binarnym będzie wymagało $log \, b$ operacji na liczbach długości nie większej niż $log \, n$. Mamy więc ograniczenie złożoności kroku pierwszego \[O(log \, n \cdot (log \,n \cdot (log \,b \cdot log \,n ))) = O(log^n \cdot log \, log \, n).\]
		\item Z Lematu \ref{r_szacowanie} wiemy, że istnieje $r \leq max\{3, \lceil log^5n \rceil \}$. Dla potencjalnych $O(log^5n)$ wartości $r$, algorytm sprawdzi $O(log^2n)$ kolejnych potęg $n$ i przyrówna je do $1$ modulo $r$. Dla kroku 2. otrzymujemy więc ograniczenie złożoności \[O(log^5n \cdot (log^2n \cdot log \,r)) = O(log^7n \cdot log\,log \,n).\]
		\item Dla możliwych $O(r)$ wartości $a$ wystarczy obliczyć $NWD(a, n)$. Algorytm Euklidesa pozwala znaleźć $NWD(a, n)$ w czasie $O(log \,n + log ^2 \, r)$, gdzie pierwszy składnik sumy odpowiada pierwszej operacji policzenia $a$ modulo $n$, po czym algorytm będzie wykonywał się na liczbach nie większych niż $r$. Mamy więc złożoność kroku 3. ograniczoną przez \[O(r \cdot (log \, n + log^2r)) = O(log^2n + log\,n \cdot log^2log \, n)).\] 
		\item W kroku 4. zostaje wykonane tylko jedno porównanie na liczbach długości nie większej niż $n$, więc ogólnym ograniczeniem złożoności kroku jest $O(log\,n)$.
		      \stepcounter{enumi}
		\item Dla danego $a$ algorytm obliczy wartość $(X + a)^n - X^n + a$ modulo $X^r - 1, \, p$. Obliczenie $(X + a)^n$ modulo $X^r - 1, \, p$ wykonane być może za pomocą wykorzystania szybkiej transformaty Fouriera w czasie $O(r \cdot log \, n \cdot log \, n)$, gdzie ostatni czynnik $log \, n$ odpowiada za złożoność wykonania operacji na współczynnikach długości $log \, n$. Mamy więc ograniczenie kroku 6. jako $O(log^7n)$.
		      \addtocounter{enumi}{-2}
		\item W kroku 5. wykonany zostanie krok 6. $\lfloor \sqrt{\phi(n)} \, log \, n \rfloor$. Mamy więc złożoność obliczeniową kroku 5. \[O(\sqrt{\phi(r)} \, log \, n \cdot log^7n) \subseteq O(\sqrt{r} \, log \, n \cdot log^7n) \subseteq O(log^{\frac{5}{2}}n \cdot log^8n) \subseteq O(log^{\frac{21}{2}}n).\]
	\end{enumerate}				
	Suma złożoności wszystkich kroków jest zdominowana przez złożoność kroku 5., więc złożoność całego algorytmu można ograniczyć przez $O(log^{\frac{21}{2}}n)$.
\end{proof}
	
\chapter{Implementacja}
    
Algorytm AKS zaimplementowałam w języku C++ (standard C++11) z użyciem biblioteki NTL w wersji 11.3.2. Wykorzystałam zaimplementowane w niej operacje na długich liczbach oraz efektywne mnożenie wielomianów.

\section{Kompilacja i sposób użycia}

Aby skompilować program \verb|aks.cpp| należy najpierw zainstalować bibliotekę NTL dostępną do ściągnięcia wraz z instrukcją na stronie \url{https://www.shoup.net/ntl/} w odpowiednim folderze.
Następnie wystarczy skompilować program poleceniem:
\begin{verbatim}
    $ g++ -g -O2 -std=c++11 -pthread -march=native aks.cpp \
     -o aks -lntl -lgmp -lm
\end{verbatim}

Kompilacja zakończy się stworzeniem pliku wykonywalnego \verb|aks|. Po jego uruchomieniu należy na standardowym wejściu podać liczbę naturalną, a program wypisze na standardowe wyjście napis \textit{PIERWSZA} lub \textit{ZŁOŻONA}. 

\section{Testowanie}

Testy poprawnościowe znajdują się w pliku \verb|corr.in|, a poprawne wyniki w pliku \verb|corr.out|. Do skorzystania z nich można użyć skryptu w pliku \verb|test.sh|, który kompiluje program, a następnie uruchamia go podając na wejściu liczby z kolejnych linii pliku \verb|corr.in|. Po wykonaniu programu dla wszystkich testów z pliku, program zwróci wynik skryptu \verb|diff|, który porównuje otrzymane wyniki z oczekiwanymi.

%%%%% BIBLIOGRAFIA

% \bibliographystyle{plain}

% \bibliographystyle{plain}
% \phantomsection
\printbibliography[heading=bibintoc]

% \addcontentsline{toc}{chapter}{Bibliografia}
% \begin{thebibliography}{1}
 
% \bibitem{aks}
% Manindra Agrawal, Neeraj Kayal, Nitin Saxena, \textit{PRIMES is in P}
% The Standard ML Core Language, by Robin Milner, July 1984.
% \\\texttt{http://sml-family.org/history/SML-proposal-7-84.pdf}

% \end{thebibliography}

\end{document}
